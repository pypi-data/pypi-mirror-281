"use strict";const tarsierId="__tarsier_id",tarsierSelector=`#${tarsierId}`,reworkdVisibilityAttr="reworkd-original-visibility",elIsClean=t=>{const o=t.getBoundingClientRect(),n=window.getComputedStyle(t),i=n.visibility==="hidden"||n.display==="none"||t.hidden||t.disabled,l=n.opacity==="0",e=o.width===0||o.height===0,s=t.tagName==="SCRIPT"||t.tagName==="STYLE";return!i&&!l&&!e&&!s},inputs=["a","button","textarea","select","details","label"],isInteractable=t=>inputs.includes(t.tagName.toLowerCase())||t.tagName.toLowerCase()==="input"&&t.type!=="hidden"||t.role==="button",text_input_types=["text","password","email","search","url","tel","number"],isTextInsertable=t=>t.tagName.toLowerCase()==="textarea"||t.tagName.toLowerCase()==="input"&&text_input_types.includes(t.type),emptyTagWhitelist=["input","textarea","select","button"],isEmpty=t=>{const o=t.tagName.toLowerCase();if(emptyTagWhitelist.includes(o)||t.childElementCount>0)return!1;if("innerText"in t&&t.innerText.trim().length===0){const n=t.querySelector("svg"),i=t.querySelector("img");return n||i?!1:isElementInViewport(t)}return!1};function isElementInViewport(t){const o=t.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}function getElementXPath(t){let o=[],n="";for(t&&t.ownerDocument!==window.document&&(n=`iframe[${t.getAttribute("iframe_index")}]`);t;){if(!t.tagName){t=t.parentNode;continue}let i=t.tagName.toLowerCase(),l=1,e=t.previousElementSibling;for(;e;)e.tagName===t.tagName&&l++,e=e.previousElementSibling;let s=t.nextElementSibling,r=!1;for(;s;){if(s.tagName===t.tagName){r=!0;break}s=s.nextElementSibling}if((l>1||r)&&(i+=`[${l}]`),t.id){if(i+=`[@id="${t.id}"]`,o.length>3)return o.unshift(i),"//"+o.join("/")}else if(t.className){const d=Array.from(t.classList);i+=`[@class="${t.className}"]`}o.unshift(i),t=t.parentNode}return n+"//"+o.join("/")}function create_tagged_span(t,o){let n;isInteractable(o)?isTextInsertable(o)?n=`[#${t}]`:o.tagName.toLowerCase()=="a"?n=`[@${t}]`:n=`[$${t}]`:n=`[${t}]`;let i=document.createElement("span");return i.id=tarsierId,i.style.position="relative",i.style.display="inline",i.style.color="white",i.style.backgroundColor="red",i.style.padding="1.5px",i.style.borderRadius="3px",i.style.fontWeight="bold",i.style.fontFamily="Arial",i.style.margin="1px",i.style.lineHeight="1.25",i.style.letterSpacing="2px",i.style.zIndex="2140000046",i.style.clip="auto",i.style.height="fit-content",i.style.width="fit-content",i.style.minHeight="fit-content",i.style.minWidth="fit-content",i.style.maxHeight="unset",i.style.maxWidth="unset",i.textContent=n,i.style.webkitTextFillColor="white",i.style.textShadow="",i.style.textDecoration="none",i.style.letterSpacing="0px",i}window.tagifyWebpage=(t=!1)=>{window.removeTags(),hideMapElements();let o=0,n={},i=[...document.body.querySelectorAll("*")];const l=document.getElementsByTagName("iframe");for(let e=0;e<l.length;e++)try{const s=l[e];console.log("iframe!",l[e]);const d=[...(s.contentDocument||s.contentWindow?.document).querySelectorAll("*")];d.forEach(p=>p.setAttribute("iframe_index",e)),i.push(...d)}catch(s){console.error("Cross-origin iframe:",s)}i.map(e=>{isInteractable(e)&&(e.childNodes.forEach(s=>{const r=i.indexOf(s);r>-1&&i.splice(r,1)}),e.querySelectorAll("*").forEach(s=>{const r=i.indexOf(s);r>-1&&isInteractable(s)&&i.splice(r,1)}))});for(let e of i)if(!(isEmpty(e)||!elIsClean(e))){if(isInteractable(e))n[o]=getElementXPath(e),o++;else if(t)for(let s of Array.from(e.childNodes))s.nodeType===Node.TEXT_NODE&&/\S/.test(s.textContent||"")&&(n[o]=getElementXPath(e),o++)}o=0;for(let e of i){if(isEmpty(e)||!elIsClean(e))continue;let s=create_tagged_span(o,e);if(isInteractable(e))isTextInsertable(e)&&e.parentElement?e.parentElement.insertBefore(s,e):e.prepend(s),o++;else if(t){for(let r of Array.from(e.childNodes))if(r.nodeType===Node.TEXT_NODE&&/\S/.test(r.textContent||"")){let d=create_tagged_span(o,e);e.insertBefore(d,r),o++}}}return absolutelyPositionMissingTags(),n};function absolutelyPositionMissingTags(){const o=document.querySelectorAll(tarsierSelector);o.forEach(n=>{const i=n.parentElement,l=i.getBoundingClientRect();let e=n.getBoundingClientRect();const s={x:(l.left+l.right)/2,y:(l.top+l.bottom)/2},r={x:(e.left+e.right)/2,y:(e.top+e.bottom)/2},d=Math.abs(s.x-r.x),p=Math.abs(s.y-r.y);if(d>500||p>500||!elIsClean(n)){n.style.position="absolute";let a=Math.max(0,l.left-(e.right+3-e.left));a=Math.min(a,window.innerWidth-(e.right-e.left));let c=Math.max(0,l.top+3);c=Math.min(c,Math.max(window.innerHeight,document.documentElement.scrollHeight)-(e.bottom-e.top)),n.style.left=`${a}px`,n.style.top=`${c}px`,i.removeChild(n),document.body.appendChild(n)}o.forEach(a=>{if(n===a)return;let c=a.getBoundingClientRect(),m=parseFloat(window.getComputedStyle(n).fontSize.split("px")[0]),g=parseFloat(window.getComputedStyle(a).fontSize.split("px")[0]);for(;e.left<c.right&&e.right>c.left&&e.top<c.bottom&&e.bottom>c.top&&m>7&&g>7;)m-=.5,g-=.5,n.style.fontSize=`${m}px`,a.style.fontSize=`${g}px`,e=n.getBoundingClientRect(),c=a.getBoundingClientRect()})})}window.removeTags=()=>{document.querySelectorAll(tarsierSelector).forEach(o=>o.remove()),showMapElements()};const GOOGLE_MAPS_OPACITY_CONTROL="__reworkd_google_maps_opacity",hideMapElements=()=>{const t=['iframe[src*="google.com/maps"]','iframe[id*="gmap_canvas"]',".maplibregl-map",".mapboxgl-map",".leaflet-container",'img[src*="maps.googleapis.com"]','[aria-label="Map"]',".cmp-location-map__map",'.map-view[data-role="mapView"]',".google_Map-wrapper",".google_map-wrapper",".googleMap-wrapper",".googlemap-wrapper",".ls-map-canvas",".gmapcluster","#googleMap","#googleMaps","#googlemaps","#googlemap","#google_map","#google_maps","#MapId",".geolocation-map-wrapper",".locatorMap"];document.querySelectorAll(t.join(", ")).forEach(o=>{const n=window.getComputedStyle(o).opacity;o.setAttribute("data-original-opacity",n),o.style.opacity="0"})},showMapElements=()=>{document.querySelectorAll(`[${GOOGLE_MAPS_OPACITY_CONTROL}]`).forEach(o=>{o.style.opacity=o.getAttribute("data-original-opacity")||"1"})};window.hideNonTagElements=()=>{document.body.querySelectorAll("*").forEach(o=>{const n=o;n.style.visibility&&n.setAttribute(reworkdVisibilityAttr,n.style.visibility),n.id.startsWith(tarsierId)?n.style.visibility="visible":n.style.visibility="hidden"})},window.revertVisibilities=()=>{document.body.querySelectorAll("*").forEach(o=>{const n=o;n.getAttribute(reworkdVisibilityAttr)?n.style.visibility=n.getAttribute(reworkdVisibilityAttr)||"true":n.style.removeProperty("visibility")})};
