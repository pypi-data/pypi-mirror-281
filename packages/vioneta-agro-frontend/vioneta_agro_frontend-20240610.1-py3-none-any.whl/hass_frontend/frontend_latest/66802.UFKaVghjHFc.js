export const id=66802;export const ids=[66802];export const modules={66802:(t,e,i)=>{i.a(t,(async(t,n)=>{try{i.r(e),i.d(e,{HuiEntityFilterCard:()=>m});var s=i(62659),r=i(76504),o=i(80792),a=(i(86176),i(40924)),d=i(18791),l=i(40068),u=i(67792),c=i(3433),h=i(67990),f=i(60368),y=i(50308),v=i(77664),_=t([y]);y=(_.then?(await _)():_)[0];let m=(0,s.A)([(0,d.EM)("hui-entity-filter-card")],(function(t,e){class i extends e{constructor(...e){super(...e),t(this)}}return{F:i,d:[{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,i){const n=(0,c.B)(t,3,e,i,["light","switch","sensor"]);return{type:"entity-filter",entities:n,conditions:n[0]?[{condition:"state",state:t.states[n[0]].state}]:[],card:{type:"entities"}}}},{kind:"field",decorators:[(0,d.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.MZ)({type:Boolean})],key:"isPanel",value:()=>!1},{kind:"field",decorators:[(0,d.MZ)({type:Boolean})],key:"editMode",value:()=>!1},{kind:"field",decorators:[(0,d.wk)()],key:"_config",value:void 0},{kind:"field",key:"_element",value:void 0},{kind:"field",key:"_configEntities",value:void 0},{kind:"field",key:"_baseCardConfig",value:void 0},{kind:"field",key:"_oldEntities",value:void 0},{kind:"method",key:"getCardSize",value:function(){return this._element?(0,l.Z)(this._element):1}},{kind:"method",key:"setConfig",value:function(t){if(!t.entities||!t.entities.length||!Array.isArray(t.entities))throw new Error("Entities must be specified");if(!(t.conditions&&Array.isArray(t.conditions)||t.state_filter&&Array.isArray(t.state_filter)||t.entities.every((t=>"object"==typeof t&&t.state_filter&&Array.isArray(t.state_filter)))))throw new Error("Incorrect filter config");this._configEntities=(0,h.L)(t.entities),this._config=t,this._baseCardConfig={type:"entities",entities:[],...this._config.card},this.lastChild&&this.removeChild(this.lastChild),this._element=this._createCardElement(this._baseCardConfig)}},{kind:"method",key:"createRenderRoot",value:function(){return this}},{kind:"method",key:"shouldUpdate",value:function(t){return this._element&&(this._element.hass=this.hass,this._element.editMode=this.editMode,this._element.isPanel=this.isPanel),!!t.has("_config")||!!t.has("hass")&&this._haveEntitiesChanged(t.get("hass"))}},{kind:"method",key:"update",value:function(t){if((0,r.A)((0,o.A)(i.prototype),"update",this).call(this,t),!(this.hass&&this._config&&this._configEntities&&this._element))return;const e=this._configEntities.filter((t=>{var e,i;const n=this.hass.states[t.entity];if(!n)return!1;const s=null!==(e=t.conditions)&&void 0!==e?e:this._config.conditions;if(s){const e=s.map((e=>(0,f.lB)(e,t.entity)));return(0,f.XH)(e,this.hass)}const r=null!==(i=t.state_filter)&&void 0!==i?i:this._config.state_filter;return!!r&&r.some((t=>(0,u.J)(n,t)))}));if(0!==e.length||!1!==this._config.show_empty){if(this.lastChild){if("HUI-ERROR-CARD"!==this._element.tagName){this._oldEntities&&e.length===this._oldEntities.length&&e.every(((t,e)=>t===this._oldEntities[e]))||(this._oldEntities=e,this._element.setConfig({...this._baseCardConfig,entities:e}))}}else this._element.setConfig({...this._baseCardConfig,entities:e}),this._oldEntities=e;this.lastChild||this.appendChild(this._element),this.hidden&&(this.style.display="block",this.toggleAttribute("hidden",!1),(0,v.r)(this,"card-visibility-changed",{value:!0}))}else this.hidden||(this.style.display="none",this.toggleAttribute("hidden",!0),(0,v.r)(this,"card-visibility-changed",{value:!1}))}},{kind:"method",key:"_haveEntitiesChanged",value:function(t){var e;if(!this.hass||!t)return!0;if(!this._configEntities)return!0;if(this.hass.localize!==t.localize)return!0;for(const e of this._configEntities){if(this.hass.states[e.entity]!==t.states[e.entity])return!0;if(e.conditions){const i=(0,f.Wx)(e.conditions);for(const e of i)if(this.hass.states[e]!==t.states[e])return!0}}if(null!==(e=this._config)&&void 0!==e&&e.conditions){var i;const e=(0,f.Wx)(null===(i=this._config)||void 0===i?void 0:i.conditions);for(const i of e)if(this.hass.states[i]!==t.states[i])return!0}return!1}},{kind:"method",key:"_createCardElement",value:function(t){const e=(0,y.te)(t);return this.hass&&(e.hass=this.hass),e.isPanel=this.isPanel,e.editMode=this.editMode,e.addEventListener("ll-rebuild",(i=>{i.stopPropagation(),this._rebuildCard(e,t)}),{once:!0}),e}},{kind:"method",key:"_rebuildCard",value:function(t,e){const i=this._createCardElement(e);t.parentElement&&t.parentElement.replaceChild(i,t),this._element=i}}]}}),a.mN);n()}catch(t){n(t)}}))},67792:(t,e,i)=>{i.d(e,{J:()=>n});const n=(t,e)=>{let i,n,s;if("object"==typeof e?(i=e.operator,n=e.value,s=e.attribute?t.attributes[e.attribute]:t.state):(i="==",n=e,s=t.state),"=="===i||"!="===i){const t="number"==typeof n||"string"==typeof n&&n.trim()&&!isNaN(Number(n)),e="number"==typeof s||"string"==typeof s&&s.trim()&&!isNaN(Number(s));t&&e&&(n=Number(n),s=Number(s))}switch(i){case"==":return s===n;case"<=":return s<=n;case"<":return s<n;case">=":return s>=n;case">":return s>n;case"!=":return s!==n;case"in":return!(!Array.isArray(n)&&"string"!=typeof n)&&(Array.isArray(n)&&(n=n.map((t=>`${t}`))),n.includes(s));case"not in":return!(!Array.isArray(n)&&"string"!=typeof n)&&(Array.isArray(n)&&(n=n.map((t=>`${t}`))),!n.includes(s));case"regex":return"string"==typeof n&&(null!==s&&"object"==typeof s?RegExp(n).test(JSON.stringify(s)):RegExp(n).test(s));default:return!1}}},60368:(t,e,i)=>{i.d(e,{CZ:()=>v,Wx:()=>u,XH:()=>l,db:()=>h,gW:()=>y,lB:()=>f});var n=i(68286),s=i(96516),r=i(55970),o=i(83378);function a(t,e){var i;if((0,r.n)(e)&&t.states[e])return null===(i=t.states[e])||void 0===i?void 0:i.state}function d(t,e){var i;const s=t.entity&&e.states[t.entity]?e.states[t.entity].state:o.Hh;let r=null!==(i=t.state)&&void 0!==i?i:t.state_not;if(Array.isArray(r)){const t=r.map((t=>a(e,t))).filter((t=>void 0!==t));r=[...r,...t]}else if("string"==typeof r){const t=a(e,r);r=[r],t&&r.push(t)}return null!=t.state?(0,n.e)(r).includes(s):!(0,n.e)(r).includes(s)}function l(t,e){return t.every((t=>{if("condition"in t)switch(t.condition){case"screen":return!!(i=t).media_query&&matchMedia(i.media_query).matches;case"user":return function(t,e){var i;return!(!t.users||null===(i=e.user)||void 0===i||!i.id)&&t.users.includes(e.user.id)}(t,e);case"numeric_state":return function(t,e){var i;const n=null===(i=t.entity?e.states[t.entity]:void 0)||void 0===i?void 0:i.state;let s=t.above,r=t.below;var o,d;"string"==typeof s&&(s=null!==(o=a(e,s))&&void 0!==o?o:s),"string"==typeof r&&(r=null!==(d=a(e,r))&&void 0!==d?d:r);const l=Number(n),u=Number(s),c=Number(r);return!isNaN(l)&&(null==t.above||isNaN(u)||u<l)&&(null==t.below||isNaN(c)||c>l)}(t,e);case"and":return function(t,e){return!t.conditions||l(t.conditions,e)}(t,e);case"or":return function(t,e){return!t.conditions||t.conditions.some((t=>l([t],e)))}(t,e);default:return d(t,e)}var i;return d(t,e)}))}function u(t){const e=new Set;for(const o of t)if("numeric_state"===o.condition)"string"==typeof o.above&&(0,r.n)(o.above)&&e.add(o.above),"string"==typeof o.below&&(0,r.n)(o.below)&&e.add(o.below);else if("state"===o.condition){var i,s;[...null!==(i=(0,n.e)(o.state))&&void 0!==i?i:[],...null!==(s=(0,n.e)(o.state_not))&&void 0!==s?s:[]].forEach((t=>{t&&(0,r.n)(t)&&e.add(t)}))}else if("conditions"in o&&o.conditions)return new Set([...e,...u(o.conditions)]);return e}function c(t){return null!=t.entity&&(null!=t.state||null!=t.state_not)}function h(t){return t.every((t=>{if("condition"in t)switch(t.condition){case"screen":return null!=t.media_query;case"user":return function(t){return null!=t.users}(t);case"numeric_state":return function(t){return null!=t.entity&&(null!=t.above||null!=t.below)}(t);case"and":case"or":return function(t){return null!=t.conditions}(t);default:return c(t)}return c(t)}))}function f(t,e){return"conditions"in t&&t.conditions?{...t,conditions:t.conditions.map((t=>f(t,e)))}:"state"===t.condition||"numeric_state"===t.condition?{...t,entity:e}:t}function y(t){return t.reduce(((t,e)=>("conditions"in e&&e.conditions&&t.push(...y(e.conditions)),"screen"===e.condition&&e.media_query&&t.push(e.media_query),t)),[])}function v(t,e){return y(t).map((t=>(0,s.m)(t,(t=>{e(t)}))))}}};
//# sourceMappingURL=66802.UFKaVghjHFc.js.map