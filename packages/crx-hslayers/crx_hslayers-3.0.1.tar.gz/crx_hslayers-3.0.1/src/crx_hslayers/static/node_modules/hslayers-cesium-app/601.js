"use strict";(self.webpackChunkhslayers_cesium_app=self.webpackChunkhslayers_cesium_app||[]).push([[601],{9601:(E,b,s)=>{s.d(b,{Os:()=>_,et:()=>N});var v=s(97790),m=s(88716),e=s(7404),y=s(93108),d=s(89204),C=s(14608),L=s(78373),g=s(91459),M=s(25550),f=s(23916);let _=(()=>{class n{constructor(t,a,i,o,r,c){this.hsMapService=t,this.hsToastService=a,this.hsLanguageService=i,this.hsLaymanService=o,this.hsCommonLaymanService=r,this.hsDialogContainerService=c}wrapLayer(t){return{layer:t,toRemove:!1,displayTitle:void 0}}removeLayer(t,a){var i=this;return(0,d.A)(function*(){const r=yield i.hsDialogContainerService.create(R,{multiple:!1,message:"DRAW.reallyDeleteThisLayer",note:i.getDeleteNote(),title:"COMMON.confirmDelete",items:[i.wrapLayer(t)],deleteFromOptions:a}).waitResult();if("yes"==r.value){const c=r.type.includes("catalogue")?i.hsMapService.getLayersArray():void 0;yield i.completeLayerRemoval(t,r.type,c)}return"yes"==r.value})()}removeMultipleLayers(t,a){var i=this;return(0,d.A)(function*(){const o=t.map(u=>i.wrapLayer(u)),c=yield i.hsDialogContainerService.create(R,{multiple:!0,message:"DRAW.pleaseCheckTheLayers",note:i.getDeleteNote(!0),title:"COMMON.selectAndConfirmToDeleteMultiple",items:o,deleteFromOptions:a}).waitResult();if("yes"==c.value){i.hsToastService.createToastPopupMessage("LAYMAN.deleteLayersRequest","LAYMAN.deletionInProgress",{toastStyleClasses:"bg-info text-white",serviceCalledFrom:"HsDrawService",customDelay:6e5});const u=o.filter(h=>h.toRemove),j=c.type.includes("catalogue")?i.hsMapService.getLayersArray():void 0;for(const h of u)yield i.completeLayerRemoval(h.layer,c.type,j);i.hsToastService.removeByText(i.hsLanguageService.getTranslation("LAYMAN.deletionInProgress",void 0))}return"yes"==c.value})()}completeLayerRemoval(t,a,i){var o=this;return(0,d.A)(function*(){"map"!==a&&(yield o.removeFromCatalogue(t)),a.includes("map")?o.hsMapService.getMap().removeLayer(t):o.tryRemovingFromMap(t,i)})()}tryRemovingFromMap(t,a){const i=a.find(o=>(0,m.mG)(o)===t);i&&this.hsMapService.getMap().removeLayer(i)}removeFromCatalogue(t){var a=this;return(0,d.A)(function*(){if(t instanceof v.A){const o=(0,m.Ao)(t);o?.format?.toLowerCase().includes("wfs")&&o?.url&&(yield a.hsLaymanService.removeLayer(t))}else yield a.hsLaymanService.removeLayer(t)})()}getDeleteNote(t){return this.hsCommonLaymanService.isAuthenticated()?t?"DRAW.deleteNotePlural":"DRAW.deleteNote":""}static#e=this.\u0275fac=function(a){return new(a||n)(e.KVO(C.F),e.KVO(L.ST),e.KVO(g.LJ),e.KVO(M.fr),e.KVO(f.wC),e.KVO(y.oE))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var p=s(60316),F=s(31968);const k=(n,l)=>({"btn-primary":n,"btn-danger":l}),D=(n,l)=>({active:n,"w-auto":l}),T=()=>({module:"LAYERS.removeLayer"});function A(n,l){if(1&n&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(": ",t.data.items[0].displayTitle,"")}}function O(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selectDeleteOption(i))}),e.EFF(1),e.nI1(2,"translateHs"),e.k0s()}if(2&n){const t=l.$implicit,a=e.XpG(2);e.Y8G("hidden","catalogue"===t&&!a.isAuthenticated)("ngClass",e.l_i(7,D,a.deleteFrom===t,"catalogue"===t)),e.BMQ("data-cy",t),e.R7$(),e.JRh(e.i5U(2,4,t,e.lJ4(10,T)))}}function I(n,l){if(1&n&&(e.j41(0,"p",20),e.EFF(1),e.nI1(2,"translateHs"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(e.bMT(2,1,t.data.note))}}function S(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",26)(1,"button",27),e.bIt("click",function(i){const o=e.eBV(t).$implicit;return e.XpG(4).checkToRemove(o),e.Njj(i.stopPropagation())}),e.k0s(),e.j41(2,"p",28),e.EFF(3),e.k0s()()}if(2&n){const t=l.$implicit;e.R7$(),e.Y8G("ngClass",t.toRemove?"hs-checkmark":"hs-uncheckmark"),e.R7$(2),e.JRh(t.displayTitle)}}function H(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",22)(1,"div",23)(2,"button",24),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.toggleAll())}),e.EFF(3),e.nI1(4,"translateHs"),e.k0s()(),e.DNE(5,S,4,2,"div",25),e.k0s()}if(2&n){const t=e.XpG(3);e.R7$(3),e.JRh(e.bMT(4,2,"SAVECOMPOSITION.form.toggleAll")),e.R7$(2),e.Y8G("ngForOf",t.data.items)}}function w(n,l){if(1&n&&(e.j41(0,"div")(1,"p",14),e.EFF(2),e.nI1(3,"translateHs"),e.k0s(),e.DNE(4,H,6,4,"div",21),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,2,t.data.message)),e.R7$(2),e.Y8G("ngIf",(null==t.data.items?null:t.data.items.length)>0)}}function x(n,l){if(1&n&&(e.j41(0,"div",13)(1,"p",14),e.EFF(2),e.nI1(3,"translateHs"),e.k0s(),e.j41(4,"div",15),e.DNE(5,O,3,11,"button",16),e.k0s()(),e.DNE(6,I,3,3,"p",17)(7,w,5,4,"div",18)),2&n){const t=e.XpG();e.R7$(2),e.SpI("",e.bMT(3,4,"LAYERS.removeLayer.deleteFrom"),": "),e.R7$(3),e.Y8G("ngForOf",t.data.deleteFromOptions),e.R7$(),e.Y8G("ngIf",t.deleteFrom&&"map"!==t.deleteFrom),e.R7$(),e.Y8G("ngIf",t.deleteFrom&&t.data.multiple)}}function $(n,l){1&n&&(e.j41(0,"p",8),e.EFF(1),e.nI1(2,"translateHs"),e.k0s()),2&n&&(e.R7$(),e.SpI("",e.bMT(2,1,"LAYERS.removeLayer.noLayersToDelete")," "))}let R=(()=>{class n{constructor(t,a,i,o){this.HsDialogContainerService=t,this.service=a,this.hsLanguageService=i,this.commonLaymanService=o,this._selectAll=!1,this.deleteAllowed=!1}ngOnInit(){if(this.isAuthenticated=this.commonLaymanService.isAuthenticated(),this.data.deleteFromOptions??=["map","mapcatalogue"],(!this.isAuthenticated||1===this.data.deleteFromOptions.length)&&(this.deleteFrom=this.data.deleteFromOptions[0],this.deleteAllowed=!this.data.multiple),this.data.items)for(const t of this.data.items)t.displayTitle=this.getTitle(t)}yes(){this.HsDialogContainerService.destroy(this),this.dialogItem.resolve({value:"yes",type:this.deleteFrom})}no(){this.HsDialogContainerService.destroy(this),this.dialogItem.resolve({value:"no"})}selectDeleteOption(t){this.deleteFrom=t,this.deleteAllowed=!this.data.multiple||this.deleteAllowed}checkToRemove(t){t.toRemove=void 0===t.toRemove||!t.toRemove,this.deleteAllowed=!!this.data.items.find(a=>a.toRemove)}toggleAll(){this._selectAll=!this._selectAll;for(const t of this.data.items)t.toRemove=this._selectAll;this.deleteAllowed=!!this.data.items.find(t=>t.toRemove)}getTitle(t){let a=t.layer instanceof v.A?(0,m.LK)(t.layer)??(0,m.mG)(t.layer):t.layer;return a||(a=this.hsLanguageService.getTranslation("COMMON.unknown",void 0)),a}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(y.oE),e.rXU(_),e.rXU(g.LJ),e.rXU(f.wC))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["hs-rm-layer-dialog"]],decls:22,vars:25,consts:[["tabindex","-1","role","dialog","aria-hidden","true",1,"modal","in"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","d-flex"],["class","text-truncate d-inline-block",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn-close",3,"click"],[1,"modal-body",2,"overflow-y","auto"],[1,"fw-bold","h6","text-center"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn",3,"click","disabled","ngClass","title"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","compositions-btn-cancel",3,"click","title"],[1,"text-truncate","d-inline-block"],[1,"d-flex","flex-column","mb-3"],[1,"fw-bold","h6"],[1,"d-flex","gap-3","justify-content-center","px-5"],["type","button","class","btn btn-sm btn-outline-primary w-50",3,"hidden","ngClass","click",4,"ngFor","ngForOf"],["class","h6 small",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-primary","w-50",3,"click","hidden","ngClass"],[1,"h6","small"],["style","max-height: 65vh;",4,"ngIf"],[2,"max-height","65vh"],[1,"d-flex","w-100","justify-content-center"],["type","button",1,"mt-1","btn","btn-primary",3,"click"],["class","d-flex align-items-center","style","word-break:break-all",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center",2,"word-break","break-all"],["type","button",1,"btn","btn-sm","m-0","p-0",3,"click","ngClass"],[1,"m-0","ps-1"]],template:function(a,i){1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e.EFF(5),e.nI1(6,"translateHs"),e.DNE(7,A,2,1,"span",5),e.k0s(),e.j41(8,"button",6),e.nI1(9,"translateHs"),e.bIt("click",function(){return i.no()}),e.k0s()(),e.j41(10,"div",7),e.DNE(11,x,8,6)(12,$,3,3,"p",8),e.k0s(),e.j41(13,"div",9)(14,"button",10),e.nI1(15,"translateHs"),e.bIt("click",function(){return i.yes()}),e.EFF(16),e.nI1(17,"translateHs"),e.k0s(),e.j41(18,"button",11),e.nI1(19,"translateHs"),e.bIt("click",function(){return i.no()}),e.EFF(20),e.nI1(21,"translateHs"),e.k0s()()()()()),2&a&&(e.R7$(5),e.SpI(" ",e.bMT(6,10,i.data.title)," "),e.R7$(2),e.Y8G("ngIf",!i.data.multiple),e.R7$(),e.BMQ("aria-label",e.bMT(9,12,"COMMON.close")),e.R7$(3),e.vxM(i.data.items.length>0?11:12),e.R7$(3),e.Y8G("disabled",!i.deleteAllowed)("ngClass",e.l_i(22,k,"map"===i.deleteFrom,"map"!==i.deleteFrom))("title",e.bMT(15,14,"COMMON.remove")),e.R7$(2),e.JRh(e.bMT(17,16,"COMMON.remove")),e.R7$(2),e.Y8G("title",e.bMT(19,18,"COMMON.back")),e.R7$(2),e.JRh(e.bMT(21,20,"COMMON.back")))},dependencies:[p.YU,p.Sq,p.bT,F.q],styles:[".modal-title[_ngcontent-%COMP%]{white-space:nowrap;width:100%}.modal-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{max-width:18ch}\n\n/*# sourceMappingURL=remove-layer-dialog.component.ts-angular-inline--2.css.map*/"]})}return n})(),N=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[p.MD]})}return n})()}}]);
//# sourceMappingURL=601.js.map