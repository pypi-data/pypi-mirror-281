{"version":3,"file":"projects_hslayers_components_trip-planner_index_ts.js","mappings":"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","sources":["webpack:///projects_hslayers_components_trip-planner_index_ts.js"],"sourcesContent":["\"use strict\";(self.webpackChunkhslayers_app=self.webpackChunkhslayers_app||[]).push([[\"projects_hslayers_components_trip-planner_index_ts\"],{48279:(ne,C,o)=>{o.r(C),o.d(C,{HsTripPlannerComponent:()=>Pe,HsTripPlannerLayerSelectorComponent:()=>q,HsTripPlannerModule:()=>Se,HsTripPlannerProfileSelectorComponent:()=>ee,HsTripPlannerService:()=>N,getWaypoint:()=>Z,profiles:()=>l,setWaypoint:()=>se});var e=o(93953),v=o(10467),D=o(93207),W=o(62087),j=o(99437),O=o(7673),b=o(4786),_=o(34958),$=o(85493),U=o(28929),F=(o(21043),o(75637),o(84688),o(73117),o(443),o(83093)),V=o(48791),M=o(47616),m=o(35901),E=o(87549);const l=[\"driving-car\",\"driving-hgv\",\"cycling-regular\",\"cycling-road\",\"cycling-mountain\",\"cycling-electric\",\"foot-walking\",\"foot-hiking\",\"wheelchair\"];var h=o(88716),S=o(14608),y=o(27426),H=o(21626),B=o(64801),re=o(22187),ie=o(78373),k=o(91459),oe=o(24025),z=o(40736);const Q=\"wp\";function se(i,c){i.set(Q,c)}function Z(i){return i.get(Q)}let N=(()=>{class i{constructor(t,n,r,s,a,p,te,R,L,I){this.HsMapService=t,this.HsUtilsService=n,this.$http=r,this.HsShareUrlService=s,this.HsEventBusService=a,this.HsToastService=p,this.HsLanguageService=te,this.HsLayerUtilsService=R,this.HsLayoutService=L,this.hsConfig=I,this.waypoints=[],this.trip={},this.orsProfiles=l,this.movable_features=new b.A,this.selectedLayerWrapper={},this.selectedProfile=l[0],this.modify=new $.A({features:this.movable_features}),this.HsEventBusService.mapClicked.subscribe(({coordinates:w})=>{\"tripPlanner\"==this.HsLayoutService.mainpanel&&(this.waypointLayer||this.createWaypointLayer(),this.routeLayer||this.createRouteLayer(),!this.HsMapService.getMap().getInteractions().getArray().find(x=>x.getActive()&&this.HsUtilsService.instOf(x,U.Ay))&&this.addWaypoint({x:w.mapProjCoordinate[0],y:w.mapProjCoordinate[1],lon:w.epsg4326Coordinate[0],lat:w.epsg4326Coordinate[1]}))}),this.HsMapService.loaded().then(w=>{w.addInteraction(this.modify),this.fillVectorLayers()})}fillVectorLayers(){var t=this;return(0,v.A)(function*(){t.HsMapService.loaded().then(n=>{t.vectorLayers=[{layer:null,title:\"newLayer\"},...t.HsMapService.getLayersArray().filter(r=>t.HsLayerUtilsService.isLayerDrawable(r)).map(r=>({layer:r,title:(0,h.LK)(r)}))],t.fillDefaultLayerWrapper(\"route\"),t.fillDefaultLayerWrapper(\"waypoints\")})})()}fillDefaultLayerWrapper(t){this.selectedLayerWrapper[t]=this.selectedLayerWrapper[t]?this.vectorLayers.find(n=>n.layer==this.selectedLayerWrapper[t].layer):this.vectorLayers[0]}createWaypointLayer(){this.waypointSource=new m.A,this.waypointLayer=new M.A({source:this.waypointSource,style:this.waypointRouteStyle}),(0,h.D6)(this.waypointLayer,this.HsLanguageService.getTranslation(\"TRIP_PLANNER.waypoints\",void 0)),this.HsMapService.getMap().addLayer(this.waypointLayer)}createRouteLayer(){this.routeSource=new m.A,this.routeLayer=new M.A({source:this.routeSource,style:this.waypointRouteStyle}),(0,h.D6)(this.routeLayer,this.HsLanguageService.getTranslation(\"TRIP_PLANNER.travelRoute\",void 0)),this.HsMapService.getMap().addLayer(this.routeLayer)}selectLayer(t,n){var r=this;return(0,v.A)(function*(){if(\"route\"==n&&(r.routeLayer=t.layer,r.routeLayer&&(r.routeSource=r.routeLayer.getSource()),r.selectedLayerWrapper.route=t),\"waypoints\"==n){r.waypointLayer=t.layer,r.waypointLayer&&(r.waypointSource=r.waypointLayer.getSource()),r.routeSource.clear(),r.waypoints.length=0,r.selectedLayerWrapper.waypoints=t;for(const s of r.waypointSource.getFeatures()){const a=(0,E.transform)(s.getGeometry().getCoordinates(),r.HsMapService.getCurrentProj().getCode(),\"EPSG:4326\"),p={lon:a[0],lat:a[1],name:\"Waypoint \"+(r.waypoints.length+1),hash:r.HsUtilsService.hashCode(JSON.stringify(\"Waypoint \"+r.waypoints.length+Math.random())),routes:{from:null,to:null},featureId:s.getId(),loading:!1};r.waypoints.push(p),void 0!==r.waypointAdded&&r.waypointAdded(p),yield r.calculateRoutes()}}})()}selectProfile(t){var n=this;return(0,v.A)(function*(){n.selectedProfile=t;for(const r of n.waypoints)n.removeRoutesForWaypoint(r);yield n.calculateRoutes()})()}getTextOnFeature(t){let n=\"\";const r=Z(t);return r&&(n=r.name,r?.routes?.to&&(n+=` (${this.formatDistance(r,\"to\")})`)),n}addWaypoint({x:t,y:n,lon:r,lat:s}){const a={lon:r,lat:s,name:\"Waypoint \"+(this.waypoints.length+1),hash:this.HsUtilsService.hashCode(JSON.stringify(\"Waypoint \"+this.waypoints.length+Math.random())),routes:{from:null,to:null},featureId:null,loading:!1},p=new _.default({wp:a,geometry:new V.default([t,n]),id:this.HsUtilsService.generateUuid()});p.setId(p.get(\"id\")),a.featureId=p.getId(),this.waypointSource.addFeature(p),this.waypoints.push(a),void 0!==this.waypointAdded&&this.waypointAdded(a),this.calculateRoutes()}waypointAdded(t){const n=this.waypointSource.getFeatureById(t.featureId);this.movable_features.push(n),n.getGeometry().on(\"change\",r=>{this.removeRoutesForWaypoint(t);const s=(0,E.transform)(n.getGeometry().getCoordinates(),this.HsMapService.getCurrentProj().getCode(),\"EPSG:4326\");t.lon=s[0],t.lat=s[1];const a=this.waypoints.indexOf(t)-1;a>-1&&(this.waypoints[a].routes.from=null,this.routeRemoved(this.waypoints[a].routes.from)),null!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.calculateRoutes()},500)})}routeRemoved(t){try{t&&this.routeSource.removeFeature(t)}catch(n){throw n}}removeRoutesForWaypoint(t){this.routeRemoved(t.routes.from),this.routeRemoved(t.routes.to),t.routes={from:null,to:null}}waypointRemoved(t){try{this.waypointSource.removeFeature(this.waypointSource.getFeatureById(t.featureId))}catch(n){throw n}}removeWaypoint(t){const n=this.waypoints.indexOf(t),r=n-1;r>-1&&(this.waypoints[r].routes.from=null),this.routeRemoved(t.routes.from),this.routeRemoved(t.routes.to);const s=n+1;s<this.waypoints.length&&(this.waypoints[s].routes.to=null),this.waypointRemoved(t),this.waypoints.splice(this.waypoints.indexOf(t),1),this.calculateRoutes()}clearAll(){this.waypoints=[],this.waypointSource.clear(),this.routeSource.clear()}routeAdded(t){this.routeSource.addFeatures(t)}calculateRoutes(){var t=this;return(0,v.A)(function*(){for(let n=0;n<t.waypoints.length-1;n++){const r=t.waypoints[n];if(null===r.routes.from){const s=t.waypoints[n+1];s.loading=!0;const a=t.HsUtilsService.proxify(`https://api.openrouteservice.org/v2/directions/${t.selectedProfile}/geojson`),p=yield(0,D.s)(t.$http.post(a,{coordinates:[[r.lon,r.lat],[s.lon,s.lat]]}).pipe((0,W.w)(1e4),(0,j.W)(L=>{let I=t.HsLanguageService.getTranslation(\"TRIP_PLANNER.serviceDown\",void 0);return 404==L.status&&(I=t.HsLanguageService.getTranslation(2010==L.error?.error?.code?\"TRIP_PLANNER.noRoutablePoint\":\"TRIP_PLANNER.missingAuth\",void 0)),t.HsToastService.createToastPopupMessage(I,t.HsLanguageService.getTranslationIgnoreNonExisting(\"ERRORMESSAGES\",L.error?.error?.message??L.message,{url:a}),{disableLocalization:!0,serviceCalledFrom:\"HsTripPlannerService\"}),(0,O.of)(null)})));if(!p)return;s.loading=!1;const R=(new F.default).readFeatures(p);R[0].getGeometry().transform(\"EPSG:4326\",t.HsMapService.getCurrentProj()),r.routes.from=R[0],s.routes.to=R[0],void 0!==t.routeAdded&&t.routeAdded(R)}}})()}formatDistance(t,n){if(t.routes[n=void 0!==n?n:\"from\"]){const s=t.routes[n]?.get(\"summary\").distance/1e3;return null==s?\"\":s.toFixed(2)+\"km\"}}static#e=this.\\u0275fac=function(n){return new(n||i)(e.KVO(S.F),e.KVO(y.MJ),e.KVO(H.Qq),e.KVO(B.JX),e.KVO(re.z),e.KVO(ie.ST),e.KVO(k.LJ),e.KVO(y.Xp),e.KVO(oe.F),e.KVO(z.Q))};static#t=this.\\u0275prov=e.jDH({token:i,factory:i.\\u0275fac,providedIn:\"root\"})}return i})();var f=o(60177),T=o(11297),Y=o(31968);const ae=i=>({show:i}),X=()=>({module:\"LAYERS\"});function le(i,c){if(1&i&&(e.j41(0,\"div\",8),e.EFF(1),e.nI1(2,\"translateHs\"),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(\" \",e.i5U(2,1,t.selectedWrapper.title,e.lJ4(4,X)),\" \")}}function ce(i,c){if(1&i){const t=e.RV6();e.j41(0,\"a\",9),e.nI1(1,\"translateHs\"),e.bIt(\"click\",function(){const r=e.eBV(t).$implicit,s=e.XpG();return s.HsTripPlannerService.selectLayer(r,s.usage),e.Njj(s.layersExpanded=!1)}),e.EFF(2),e.nI1(3,\"translateHs\"),e.k0s()}if(2&i){const t=c.$implicit;e.Y8G(\"title\",e.i5U(1,2,t.title,e.lJ4(8,X))),e.R7$(2),e.JRh(e.i5U(3,5,t.title,e.lJ4(9,X)))}}let q=(()=>{class i{constructor(t,n){this.HsTripPlannerService=t,this.HsLayerUtilsService=n}static#e=this.\\u0275fac=function(n){return new(n||i)(e.rXU(N),e.rXU(y.Xp))};static#t=this.\\u0275cmp=e.VBU({type:i,selectors:[[\"hs-trip-planner-layer-selector\"]],inputs:{label:\"label\",usage:\"usage\",selectedWrapper:\"selectedWrapper\"},decls:9,vars:7,consts:[[1,\"flex-row\",\"w-100\",\"m-auto\",\"justify-content-center\",\"align-items-center\",2,\"display\",\"flex\"],[1,\"m-0\",\"p-0\",\"flex-fill\",\"text-primary\"],[\"ngbDropdown\",\"\",\"placement\",\"bottom\",2,\"max-width\",\"50%\"],[\"type\",\"button\",\"ngbDropdownToggle\",\"\",\"aria-haspopup\",\"true\",1,\"btn\",\"btn-sm\",\"rounded-0\",\"hs-toolbar-button\",\"d-flex\",\"align-items-center\",\"mw-100\",3,\"click\"],[\"class\",\"text-truncate\",4,\"ngIf\"],[\"ngbDropdownMenu\",\"\",2,\"transform\",\"translateX(25%)\",\"width\",\"15em\",3,\"ngClass\"],[1,\"d-flex\",\"align-items-center\",\"w-100\",\"flex-column\"],[\"class\",\"dropdown-item text-truncate\",\"data-toggle\",\"tooltip\",3,\"title\",\"click\",4,\"ngFor\",\"ngForOf\"],[1,\"text-truncate\"],[\"data-toggle\",\"tooltip\",1,\"dropdown-item\",\"text-truncate\",3,\"click\",\"title\"]],template:function(n,r){1&n&&(e.j41(0,\"div\",0)(1,\"p\",1),e.EFF(2),e.k0s(),e.j41(3,\"div\",2)(4,\"button\",3),e.bIt(\"click\",function(){return r.layersExpanded=!r.layersExpanded,r.HsTripPlannerService.fillVectorLayers()}),e.DNE(5,le,3,5,\"div\",4),e.k0s(),e.j41(6,\"div\",5)(7,\"div\",6),e.DNE(8,ce,4,10,\"a\",7),e.k0s()()()()),2&n&&(e.R7$(2),e.SpI(\"\",r.label,\":\"),e.R7$(2),e.BMQ(\"aria-expanded\",r.layersExpanded),e.R7$(),e.Y8G(\"ngIf\",void 0!==r.selectedWrapper),e.R7$(),e.Y8G(\"ngClass\",e.eq3(5,ae,r.layersExpanded)),e.R7$(2),e.Y8G(\"ngForOf\",r.HsTripPlannerService.vectorLayers))},dependencies:[f.YU,f.Sq,f.bT,T.tg,T.do,T.U0,Y.q],encapsulation:2})}return i})();const pe=i=>({show:i}),J=()=>({module:\"TRIP_PLANNER.profiles\"});function de(i,c){if(1&i&&(e.j41(0,\"div\",8),e.EFF(1),e.nI1(2,\"translateHs\"),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(\" \",e.i5U(2,1,t.selectedProfile,e.lJ4(4,J)),\" \")}}function ue(i,c){if(1&i){const t=e.RV6();e.j41(0,\"a\",9),e.nI1(1,\"translateHs\"),e.bIt(\"click\",function(){const r=e.eBV(t).$implicit,s=e.XpG();return s.hsTripPlannerService.selectProfile(r),e.Njj(s.profilesExpanded=!1)}),e.EFF(2),e.nI1(3,\"translateHs\"),e.k0s()}if(2&i){const t=c.$implicit;e.Y8G(\"title\",e.i5U(1,2,t,e.lJ4(8,J))),e.R7$(2),e.JRh(e.i5U(3,5,t,e.lJ4(9,J)))}}let ee=(()=>{class i{constructor(t){this.hsTripPlannerService=t}static#e=this.\\u0275fac=function(n){return new(n||i)(e.rXU(N))};static#t=this.\\u0275cmp=e.VBU({type:i,selectors:[[\"hs-trip-planner-profile-selector\"]],inputs:{selectedProfile:\"selectedProfile\"},decls:10,vars:9,consts:[[1,\"flex-row\",\"w-100\",\"m-auto\",\"justify-content-center\",\"align-items-center\",2,\"display\",\"flex\"],[1,\"m-0\",\"p-0\",\"flex-fill\",\"text-primary\"],[\"ngbDropdown\",\"\",\"placement\",\"bottom\",2,\"max-width\",\"50%\"],[\"type\",\"button\",\"ngbDropdownToggle\",\"\",\"aria-haspopup\",\"true\",1,\"btn\",\"btn-sm\",\"rounded-0\",\"hs-toolbar-button\",\"d-flex\",\"align-items-center\",\"mw-100\",3,\"click\"],[\"class\",\"text-truncate\",4,\"ngIf\"],[\"ngbDropdownMenu\",\"\",2,\"transform\",\"translateX(25%)\",\"width\",\"15em\",3,\"ngClass\"],[1,\"d-flex\",\"align-items-center\",\"w-100\",\"flex-column\"],[\"class\",\"dropdown-item text-truncate\",\"data-toggle\",\"tooltip\",3,\"title\",\"click\",4,\"ngFor\",\"ngForOf\"],[1,\"text-truncate\"],[\"data-toggle\",\"tooltip\",1,\"dropdown-item\",\"text-truncate\",3,\"click\",\"title\"]],template:function(n,r){1&n&&(e.j41(0,\"div\",0)(1,\"p\",1),e.EFF(2),e.nI1(3,\"translateHs\"),e.k0s(),e.j41(4,\"div\",2)(5,\"button\",3),e.bIt(\"click\",function(){return r.profilesExpanded=!r.profilesExpanded}),e.DNE(6,de,3,5,\"div\",4),e.k0s(),e.j41(7,\"div\",5)(8,\"div\",6),e.DNE(9,ue,4,10,\"a\",7),e.k0s()()()()),2&n&&(e.R7$(2),e.SpI(\"\",e.bMT(3,5,\"TRIP_PLANNER.selectProfile\"),\":\"),e.R7$(3),e.BMQ(\"aria-expanded\",r.profilesExpanded),e.R7$(),e.Y8G(\"ngIf\",void 0!==r.selectedProfile),e.R7$(),e.Y8G(\"ngClass\",e.eq3(7,pe,r.profilesExpanded)),e.R7$(2),e.Y8G(\"ngForOf\",r.hsTripPlannerService.orsProfiles))},dependencies:[f.YU,f.Sq,f.bT,T.tg,T.do,T.U0,Y.q],encapsulation:2})}return i})();var K=o(25849),A=o(89417),fe=o(70258);const he=(i,c)=>c.hash,me=()=>({standalone:!0});function ye(i,c){if(1&i){const t=e.RV6();e.j41(0,\"div\",7)(1,\"div\",11)(2,\"a\",13),e.bIt(\"click\",function(){const r=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleEdit(r))}),e.EFF(3),e.k0s(),e.j41(4,\"input\",14),e.mxI(\"ngModelChange\",function(r){const s=e.eBV(t).$implicit;return e.DH7(s.name,r)||(s.name=r),e.Njj(r)}),e.bIt(\"blur\",function(){const r=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleEdit(r))}),e.k0s()(),e.j41(5,\"div\",12),e.nrm(6,\"span\",15),e.k0s(),e.j41(7,\"div\",16),e.EFF(8),e.k0s(),e.j41(9,\"div\",12)(10,\"a\",17),e.nI1(11,\"translateHs\"),e.bIt(\"click\",function(){const r=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.hsTripPlannerService.removeWaypoint(r))}),e.nrm(12,\"i\",18),e.k0s()()()}if(2&i){const t=c.$implicit,n=e.XpG(2);e.R7$(2),e.Y8G(\"hidden\",!!t.editMode),e.R7$(),e.JRh(t.name),e.R7$(),e.R50(\"ngModel\",t.name),e.Y8G(\"ngModelOptions\",e.lJ4(10,me))(\"hidden\",!t.editMode),e.R7$(2),e.Y8G(\"hidden\",!t.loading),e.R7$(2),e.SpI(\" \",n.formatDistance(t),\" \"),e.R7$(2),e.Y8G(\"title\",e.bMT(11,8,\"TRIP_PLANNER.removeWaypoint\"))}}function ve(i,c){1&i&&(e.j41(0,\"div\",8),e.EFF(1),e.nI1(2,\"translateHs\"),e.k0s()),2&i&&(e.R7$(),e.SpI(\" \",e.bMT(2,1,\"TRIP_PLANNER.waypointDrawingHint\"),\" \"))}function ge(i,c){if(1&i){const t=e.RV6();e.j41(0,\"a\",19),e.bIt(\"click\",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.hsTripPlannerService.clearAll())}),e.EFF(1),e.nI1(2,\"translateHs\"),e.k0s()}2&i&&(e.R7$(),e.JRh(e.bMT(2,1,\"TRIP_PLANNER.clearWaypoints\")))}function Te(i,c){if(1&i&&(e.j41(0,\"div\",1),e.nrm(1,\"hs-panel-header\",2),e.j41(2,\"div\",3),e.nrm(3,\"hs-trip-planner-layer-selector\",4),e.nI1(4,\"translateHs\"),e.nrm(5,\"hs-trip-planner-layer-selector\",5),e.nI1(6,\"translateHs\"),e.nrm(7,\"hs-trip-planner-profile-selector\",6),e.Z7z(8,ye,13,11,\"div\",7,he),e.DNE(10,ve,3,3,\"div\",8)(11,ge,3,3,\"a\",9),e.nrm(12,\"br\"),e.j41(13,\"div\",10)(14,\"div\",11)(15,\"strong\"),e.EFF(16),e.nI1(17,\"translateHs\"),e.k0s()(),e.j41(18,\"div\",12),e.EFF(19),e.k0s()()()()),2&i){const t=e.XpG();e.Y8G(\"ngClass\",t.panelWidthClass),e.R7$(),e.Y8G(\"panelTabs\",\"TRIP_PLANNER\"),e.R7$(2),e.Y8G(\"label\",e.bMT(4,10,\"TRIP_PLANNER.routerLayer\"))(\"selectedWrapper\",t.hsTripPlannerService.selectedLayerWrapper.route),e.R7$(2),e.Y8G(\"label\",e.bMT(6,12,\"TRIP_PLANNER.waypointLayer\"))(\"selectedWrapper\",t.hsTripPlannerService.selectedLayerWrapper.waypoints),e.R7$(2),e.Y8G(\"selectedProfile\",t.hsTripPlannerService.selectedProfile),e.R7$(),e.Dyx(t.hsTripPlannerService.waypoints),e.R7$(2),e.vxM(0===t.hsTripPlannerService.waypoints.length?10:11),e.R7$(6),e.SpI(\"\",e.bMT(17,14,\"TRIP_PLANNER.totalDistance\"),\":\"),e.R7$(3),e.SpI(\" \",t.totalDistance(),\"\")}}let Pe=(()=>{class i extends K.aH{constructor(t,n,r,s,a,p){super(),this.hsConfig=t,this.hsLanguageService=n,this.hsLayerUtilsService=r,this.hsMapService=s,this.hsTripPlannerService=a,this.hsUtilsService=p,this.name=\"tripPlanner\"}ngOnInit(){var t=()=>super.ngOnInit,n=this;return(0,v.A)(function*(){t().call(n),void 0===n.hsConfig.default_layers?n.hsConfig.default_layers=[]:n.hsConfig.default_layers.push(n.hsTripPlannerService.routeLayer)})()}formatDistance(t){return this.hsTripPlannerService.formatDistance(t)}totalDistance(){let t=0;return this.hsTripPlannerService.waypoints.forEach(n=>{n.routes.from&&(t+=n.routes.from.get(\"summary\").distance/1e3)}),t.toFixed(2)+\"km\"}toggleEdit(t){t.editMode=!t.editMode;const n=this.hsTripPlannerService.waypointLayer.getSource();(0,h.YD)(n.getFeatureById(t.featureId),t.editMode)}static#e=this.\\u0275fac=function(n){return new(n||i)(e.rXU(z.Q),e.rXU(k.LJ),e.rXU(y.Xp),e.rXU(S.F),e.rXU(N),e.rXU(y.MJ))};static#t=this.\\u0275cmp=e.VBU({type:i,selectors:[[\"hs-trip-planner\"]],features:[e.Vt3],decls:2,vars:3,consts:[[\"class\",\"card hs-main-panel\",3,\"ngClass\",4,\"ngIf\"],[1,\"card\",\"hs-main-panel\",3,\"ngClass\"],[\"name\",\"tripPlanner\",3,\"panelTabs\"],[1,\"card-body\",\"d-flex\",\"flex-column\",\"px-3\"],[\"usage\",\"route\",3,\"label\",\"selectedWrapper\"],[\"usage\",\"waypoints\",3,\"label\",\"selectedWrapper\"],[3,\"selectedProfile\"],[1,\"d-flex\",\"flex-row\",\"align-items-center\",\"px-2\"],[\"role\",\"alert\",1,\"alert\",\"alert-primary\"],[1,\"accordion\",\"align-self-end\",\"btn\",\"btn-danger\",\"btn-sm\",\"m-2\"],[1,\"d-flex\",\"flex-row\"],[1,\"p-1\",\"flex-grow-1\"],[1,\"p-1\"],[3,\"click\",\"hidden\"],[1,\"form-control\",\"hs-waypoint-name\",3,\"ngModelChange\",\"blur\",\"ngModel\",\"ngModelOptions\",\"hidden\"],[1,\"hs-loader\",\"hs-loader-dark\",3,\"hidden\"],[1,\"p-1\",2,\"margin-top\",\"1em\"],[\"data-toggle\",\"tooltip\",1,\"p-1\",3,\"click\",\"title\"],[1,\"icon-remove-circle\",2,\"color\",\"rgb(228, 99, 99)\"],[1,\"accordion\",\"align-self-end\",\"btn\",\"btn-danger\",\"btn-sm\",\"m-2\",3,\"click\"]],template:function(n,r){1&n&&(e.DNE(0,Te,20,16,\"div\",0),e.nI1(1,\"async\")),2&n&&e.Y8G(\"ngIf\",e.bMT(1,1,r.isVisible$))},dependencies:[A.me,A.BC,A.vS,f.YU,f.bT,fe.k,q,ee,f.Jj,Y.q],encapsulation:2})}return i})(),Se=(()=>{class i{static#e=this.\\u0275fac=function(n){return new(n||i)};static#t=this.\\u0275mod=e.$C({type:i});static#n=this.\\u0275inj=e.G2t({imports:[A.YN,f.MD,K.Zz,K.k4,T.zH]})}return i})()},62087:(ne,C,o)=>{o.d(C,{w:()=>$});var e=o(43236),v=o(28211),D=o(39974),W=o(58750),j=o(81853),O=o(54360),b=o(45225);const _=(0,j.L)(d=>function(u=null){d(this),this.message=\"Timeout has occurred\",this.name=\"TimeoutError\",this.info=u});function $(d,g){const{first:u,each:P,with:G=U,scheduler:F=g??e.E,meta:V=null}=(0,v.v)(d)?{first:d}:\"number\"==typeof d?{each:d}:d;if(null==u&&null==P)throw new TypeError(\"No timeout provided.\");return(0,D.N)((M,m)=>{let E,l,h=null,S=0;const y=H=>{l=(0,b.N)(m,F,()=>{try{E.unsubscribe(),(0,W.Tg)(G({meta:V,lastValue:h,seen:S})).subscribe(m)}catch(B){m.error(B)}},H)};E=M.subscribe((0,O._)(m,H=>{l?.unsubscribe(),S++,m.next(h=H),P>0&&y(P)},void 0,void 0,()=>{l?.closed||l?.unsubscribe(),h=null})),!S&&y(null!=u?\"number\"==typeof u?u:+u-F.now():P)})}function U(d){throw new _(d)}}}]);"],"names":[],"sourceRoot":""}