"use strict";(self.webpackChunksatysfi_notebook_tweaks=self.webpackChunksatysfi_notebook_tweaks||[]).push([[445],{445:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(72),s=n(209),r=n(571);const a="satysfi-notebook-tweaks:export-pdf";var i=n(953),l=n(733);const d={id:"satysfi-notebook-tweaks:plugin",description:"A small tweaks for SATySFi Notebook environment.",autoStart:!0,requires:[o.ICommandPalette,r.IRenderMimeRegistry],activate:(e,t,n)=>{e.commands.addCommand(a,{label:"SATySFi Notebook: Export entire document as PDF",isVisible:()=>{var t;const n=e.shell.currentWidget;return n instanceof s.NotebookPanel&&"satysfi"===(null===(t=n.sessionContext.kernelPreference.language)||void 0===t?void 0:t.toLowerCase())},execute:()=>(async(e,t)=>{var n;const a=e.shell.currentWidget;if(!(a instanceof s.NotebookPanel&&a.model))return;const d=null===(n=a.sessionContext.session)||void 0===n?void 0:n.kernel;if(!d)return;const[c,u]=a.model.sharedModel.cells.filter((({cell_type:e})=>"code"===e)).map((({source:e})=>e)).filter((e=>!e.startsWith("%?")&&!e.startsWith("%%"))).map((e=>{if(e.startsWith("%!"))return[e,null];const t=`notebook-export-${(0,l.v4)()}`;return[`%! val ${t} = '< ${e} >`,t]})).reduce((([e,t],[n,o])=>[[...e,n],[...t,o]]),[[],[]]),m=u.filter((e=>e)).map((e=>`#${e};`)).join(" "),f=e.serviceManager.kernels.startNew({name:d.name},{clientId:d.clientId,username:d.username,handleComms:d.handleComms}),k=await["%% render-in-pdf",...c].reduce((async(e,t)=>e.then((e=>new Promise(((n,o)=>{e.requestExecute({code:t}).onIOPub=t=>{i.KernelMessage.isStatusMsg(t)&&"idle"===t.content.execution_state&&n(e),i.KernelMessage.isErrorMsg(t)&&o(new Error(t.content.evalue))}}))))),f);k.requestExecute({code:m}).onIOPub=n=>{if(!i.KernelMessage.isExecuteResultMsg(n))return;k.shutdown();const s=t.createRenderer("application/pdf"),l=new o.MainAreaWidget({content:s});l.title.label=`PDF Export: ${a.title.label}`,l.id=`${a.id}-exported-pdf`,l.revealed.then((()=>{s.renderModel(new r.MimeModel(n.content))})),e.shell.add(l,"main",{mode:"tab-after"})}})(e,n)}),t.addItem({command:a,category:"notebook"})}}}}]);