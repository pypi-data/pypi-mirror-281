{"version":3,"file":"js/module_receipts.c0603833.bundle.js","mappings":"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","sources":["webpack:///indico/modules/receipts/client/js/printing/print.jsx","webpack:///indico/modules/receipts/client/js/printing/PrintReceiptsModal.jsx","webpack:///indico/web/client/js/utils/browser.js","webpack:///indico/modules/receipts/client/js/index.js"],"sourcesContent":["// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport printReceiptsURL from 'indico-url:receipts.generate_receipts';\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Button, ButtonGroup, Icon, Label, Message, Modal, Table} from 'semantic-ui-react';\n\nimport {handleSubmitError} from 'indico/react/forms';\nimport {Translate} from 'indico/react/i18n';\nimport {injectModal} from 'indico/react/util';\nimport {indicoAxios} from 'indico/utils/axios';\nimport {camelizeKeys, snakifyKeys} from 'indico/utils/case';\n\n/**\n * This modal shows to the user any non-fatal templating errors which may have happened during\n * the templating process. The user may choose to download the result anyway (pre-downloaded by\n * the browser).\n */\nfunction PrintingErrorsModal({onRetry, onClose, errors}) {\n  const [open, setOpen] = useState(true);\n  return (\n    <Modal open={open} onClose={onClose} closeIcon>\n      <Modal.Header>\n        <Translate>Templating Errors</Translate>\n      </Modal.Header>\n      <Modal.Content>\n        <Message error>\n          <Translate>There were some errors while trying to generate your documents.</Translate>\n        </Message>\n        <Table celled fixed>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell>\n                <Translate>Registrant's name</Translate>\n              </Table.HeaderCell>\n              <Table.HeaderCell>\n                <Translate>Missing fields</Translate>\n              </Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>\n            {errors.map(({registration, undefineds}) => (\n              <Table.Row key={registration.id}>\n                <Table.Cell>{registration.fullName}</Table.Cell>\n                <Table.Cell>\n                  {undefineds.map(name => (\n                    <Label key={`${registration.id}-${name}`} color=\"red\">\n                      {name}\n                    </Label>\n                  ))}\n                </Table.Cell>\n              </Table.Row>\n            ))}\n          </Table.Body>\n        </Table>\n      </Modal.Content>\n      <Modal.Actions>\n        <ButtonGroup>\n          <Button\n            onClick={async () => {\n              await onRetry();\n              setOpen(false);\n              onClose();\n            }}\n            primary\n          >\n            <Icon name=\"sync\" />\n            <Translate>Generate anyway</Translate>\n          </Button>\n          <Button\n            onClick={() => {\n              setOpen(false);\n              onClose();\n            }}\n          >\n            <Translate>Cancel</Translate>\n          </Button>\n        </ButtonGroup>\n      </Modal.Actions>\n    </Modal>\n  );\n}\n\nPrintingErrorsModal.propTypes = {\n  onRetry: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  errors: PropTypes.arrayOf(\n    PropTypes.shape({\n      registration: PropTypes.shape({\n        firstName: PropTypes.string,\n        lastName: PropTypes.string,\n      }),\n      undefineds: PropTypes.arrayOf(PropTypes.string),\n    })\n  ).isRequired,\n};\n\n/**\n * Handle the printing logic for a given template on a given event, based on previous user input.\n *\n * @param {number} eventId - Event ID\n * @param {Array.<String>} registrationIds - IDs of registrants to print\n * @param {Array.<Object>} values - custom field values to use in the template\n */\nexport async function printReceipt(eventId, registrationIds, values) {\n  const printReceiptsRequest = async (registrations, force) => {\n    const {template: templateId, ...data} = values;\n    data.registration_ids = registrations;\n    data.force = force;\n    const resp = await indicoAxios.post(printReceiptsURL(snakifyKeys({eventId, templateId})), data);\n    return resp.data;\n  };\n  try {\n    const data = await printReceiptsRequest(registrationIds, false);\n    let receiptIds = data.receipt_ids;\n    if (data.errors.length) {\n      await new Promise(resolve => {\n        injectModal(resolveModal => (\n          <PrintingErrorsModal\n            onRetry={async () => {\n              const retryData = await printReceiptsRequest(\n                [...new Set(data.errors.map(e => e.registration.id))],\n                true\n              );\n              receiptIds = [...receiptIds, ...retryData.receipt_ids];\n            }}\n            onClose={() => {\n              resolve();\n              resolveModal();\n            }}\n            errors={camelizeKeys(data.errors)}\n          />\n        ));\n      });\n    }\n    return {receiptIds, error: null};\n  } catch (error) {\n    return {receiptIds: null, error: handleSubmitError(error)};\n  }\n}\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport allTemplatesURL from 'indico-url:receipts.all_templates';\nimport eventImagesURL from 'indico-url:receipts.images';\nimport exportReceiptsURL from 'indico-url:receipts.receipts_export';\nimport previewReceiptsURL from 'indico-url:receipts.receipts_preview';\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Field, FormSpy} from 'react-final-form';\nimport {Button, Dropdown, Form, Grid, Header, Icon, Message, Segment} from 'semantic-ui-react';\n\nimport {\n  formatters,\n  FinalCheckbox,\n  FinalDropdown,\n  FinalField,\n  FinalInput,\n  FinalSubmitButton,\n} from 'indico/react/forms';\nimport {FinalModalForm} from 'indico/react/forms/final-form';\nimport {useIndicoAxios} from 'indico/react/hooks';\nimport {Param, Plural, PluralTranslate, Singular, Translate} from 'indico/react/i18n';\nimport {handleAxiosError, indicoAxios} from 'indico/utils/axios';\nimport {downloadBlob} from 'indico/utils/browser';\nimport {snakifyKeys} from 'indico/utils/case';\n\nimport Previewer from '../templates/Previewer';\n\nimport {printReceipt} from './print';\nimport TemplateParameterEditor, {getDefaultFieldValue} from './TemplateParameterEditor';\n\nconst makeSubmitLabel = ({publish, notify_users: notifyUsers}, numRegistrants) => {\n  if (publish) {\n    return notifyUsers\n      ? PluralTranslate.string(\n          'Publish and send to registrant',\n          'Publish and send to registrants',\n          numRegistrants\n        )\n      : PluralTranslate.string(\n          'Save and publish to registration',\n          'Save and publish to registrations',\n          numRegistrants\n        );\n  }\n  return notifyUsers\n    ? PluralTranslate.string(\n        'Save and send to registrant',\n        'Save and send to registrants',\n        numRegistrants\n      )\n    : PluralTranslate.string('Save to registration', 'Save to registrations', numRegistrants);\n};\n\nconst downloadOptions = [\n  {\n    key: 'pdf',\n    value: 'pdf',\n    text: Translate.string('as a single PDF document'),\n  },\n  {\n    key: 'zip',\n    value: 'zip',\n    text: Translate.string('as a ZIP archive'),\n  },\n];\n\nconst archiveFilename = {\n  pdf: 'documents.pdf',\n  zip: 'documents.zip',\n};\n\n/**\n * This modal presents the user with a structured interface to download, e-mail or publish\n * receipts based on information from specific event registrations.\n */\nexport default function PrintReceiptsModal({onClose, registrationIds, eventId}) {\n  const [receiptIds, setReceiptIds] = useState([]);\n  const [downloading, setDownloading] = useState(false);\n\n  const {data: templateList, loading} = useIndicoAxios(allTemplatesURL({event_id: eventId}), {\n    trigger: eventId,\n    camelize: true,\n  });\n  const ready = !loading && !!templateList;\n\n  const makeUpdateTemplateFields = form => templateId => {\n    const {customFields, defaultFilename, title} = templateList.find(t => t.id === templateId);\n    form.change(\n      'custom_fields',\n      customFields\n        ? Object.assign({}, ...customFields.map(f => ({[f.name]: getDefaultFieldValue(f)})))\n        : {}\n    );\n    form.change('filename', defaultFilename || formatters.slugify(title));\n  };\n\n  const downloadReceipts = async format => {\n    setDownloading(true);\n    try {\n      const {data: downloadedData} = await indicoAxios.post(\n        exportReceiptsURL(snakifyKeys({eventId, format})),\n        snakifyKeys({receiptIds}),\n        {responseType: 'blob'}\n      );\n      downloadBlob(archiveFilename[format], downloadedData);\n    } catch (error) {\n      handleAxiosError(error);\n    }\n    setDownloading(false);\n  };\n\n  const getCustomFields = templateId =>\n    ready && templateList.find(tpl => tpl.id === templateId)?.customFields;\n\n  return (\n    <FinalModalForm\n      id=\"print-receipts\"\n      size=\"large\"\n      onSubmit={async values => {\n        const {receiptIds: printedReceiptIds, error} = await printReceipt(\n          eventId,\n          registrationIds,\n          values\n        );\n        if (error) {\n          return error;\n        } else if (printedReceiptIds.length > 0) {\n          setReceiptIds(printedReceiptIds);\n        }\n      }}\n      initialValues={{\n        custom_fields: {},\n        document_type: 'none',\n        filename: 'document',\n        save_config: true,\n      }}\n      onClose={() => onClose(receiptIds.length > 0)}\n      header={Translate.string('Generate Documents')}\n      keepDirtyOnReinitialize\n      noSubmitButton\n      disabledAfterSubmit\n    >\n      {fprops => (\n        <>\n          <Message color={receiptIds.length === 0 ? 'teal' : 'green'}>\n            <Icon name=\"print\" size=\"big\" />\n            {receiptIds.length === 0 ? (\n              <PluralTranslate count={registrationIds.length}>\n                <Singular>Generating document for a single registrant</Singular>\n                <Plural>\n                  Generating documents for{' '}\n                  <Param\n                    name=\"numberOfRegistrants\"\n                    value={registrationIds.length}\n                    wrapper={<strong />}\n                  />{' '}\n                  registrants\n                </Plural>\n              </PluralTranslate>\n            ) : (\n              <PluralTranslate count={receiptIds.length}>\n                <Singular>Successfully generated document for a single registrant</Singular>\n                <Plural>\n                  Successfully generated{' '}\n                  <Param name=\"numberOfReceipts\" value={receiptIds.length} wrapper={<strong />} />{' '}\n                  documents\n                </Plural>\n              </PluralTranslate>\n            )}\n          </Message>\n          <Grid columns={2} divided>\n            <Grid.Column>\n              <FinalDropdown\n                name=\"template\"\n                loading={!ready}\n                label={Translate.string('Document Template')}\n                placeholder={Translate.string('Select a document template')}\n                options={\n                  ready\n                    ? templateList.map(({id, title}) => ({key: id, text: title, value: id}))\n                    : []\n                }\n                onChange={makeUpdateTemplateFields(fprops.form)}\n                disabled={receiptIds.length > 0}\n                required\n                selection\n              />\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: template}}) => (\n                  <FinalField\n                    name=\"custom_fields\"\n                    component={TemplateParameterEditor}\n                    customFields={template ? getCustomFields(template) : []}\n                    title={Translate.string('Template Parameters')}\n                    disabled={receiptIds.length > 0}\n                    fetchImagesURL={eventImagesURL({event_id: eventId})}\n                    defaultOpen\n                  />\n                )}\n              </Field>\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: template}}) => (\n                  <FinalInput\n                    name=\"filename\"\n                    label={Translate.string('Filename')}\n                    type=\"text\"\n                    componentLabel=\"-{n}.pdf\"\n                    labelPosition=\"right\"\n                    disabled={!template || receiptIds.length > 0}\n                    format={v => formatters.slugify(v).replace(/\\.pdf$/, '')}\n                    formatOnBlur\n                    required\n                    fluid\n                  />\n                )}\n              </Field>\n              <FinalCheckbox\n                name=\"save_config\"\n                label={Translate.string('Remember settings')}\n                description={Translate.string(\n                  'Prefill template parameters (if present) and filename when generating more ' +\n                    'documents for the same template in this event.'\n                )}\n                disabled={receiptIds.length > 0}\n              />\n              <FinalCheckbox\n                name=\"publish\"\n                label={Translate.string('Publish document')}\n                description={PluralTranslate.string(\n                  'Make the resulting document available on the registration page.',\n                  'Make the resulting documents available on the registration pages.',\n                  registrationIds.length\n                )}\n                disabled={receiptIds.length > 0}\n              />\n              <Field name=\"publish\" subscription={{value: true}}>\n                {({input: {value: publish}}) => (\n                  <FinalCheckbox\n                    name=\"notify_users\"\n                    label={PluralTranslate.string(\n                      'Notify registrants via e-mail',\n                      'Notify registrants via e-mail',\n                      registrationIds.length\n                    )}\n                    description={\n                      publish\n                        ? PluralTranslate.string(\n                            'Send an e-mail to the registrant informing them that the document is available.',\n                            'Send an e-mail to the registrants informing them that the document is available.',\n                            registrationIds.length\n                          )\n                        : PluralTranslate.string(\n                            'Send an e-mail to the registrant with the document attached.',\n                            'Send an e-mail to the registrants with the document attached.',\n                            registrationIds.length\n                          )\n                    }\n                    disabled={receiptIds.length > 0}\n                  />\n                )}\n              </Field>\n              <Form.Group style={{alignItems: 'center'}}>\n                <FormSpy subscription={{values: true}}>\n                  {({values}) => (\n                    <FinalSubmitButton\n                      label={makeSubmitLabel(values, registrationIds.length)}\n                      icon={values.notify_users ? 'send' : 'save'}\n                      style={{width: '100%'}}\n                      disabledAfterSubmit\n                      fluid\n                    />\n                  )}\n                </FormSpy>\n                {receiptIds.length > 0 && (\n                  <>\n                    <Icon name=\"check\" color=\"green\" size=\"large\" />\n                    <Dropdown\n                      options={downloadOptions}\n                      scrolling\n                      icon={null}\n                      value={null}\n                      selectOnBlur={false}\n                      selectOnNavigation={false}\n                      onChange={(_, {value}) => downloadReceipts(value)}\n                      trigger={\n                        <Button\n                          icon\n                          style={{whiteSpace: 'nowrap', marginLeft: '1em'}}\n                          type=\"button\"\n                          loading={downloading}\n                        >\n                          <Icon name=\"download\" /> <Translate>Download</Translate>{' '}\n                          <Icon name=\"caret down\" />\n                        </Button>\n                      }\n                    />\n                  </>\n                )}\n              </Form.Group>\n            </Grid.Column>\n            <Grid.Column>\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: templateId}}) => (\n                  <Field name=\"custom_fields\" subscription={{value: true}}>\n                    {({input: {value: customFields}}) =>\n                      templateId ? (\n                        <Previewer\n                          url={previewReceiptsURL(snakifyKeys({eventId, templateId}))}\n                          data={snakifyKeys({customFields, registrationIds})}\n                        />\n                      ) : (\n                        <Segment placeholder>\n                          <Header icon>\n                            <Icon name=\"eye\" />\n                            <Translate>Please select a template to preview it...</Translate>\n                          </Header>\n                        </Segment>\n                      )\n                    }\n                  </Field>\n                )}\n              </Field>\n            </Grid.Column>\n          </Grid>\n        </>\n      )}\n    </FinalModalForm>\n  );\n}\n\nPrintReceiptsModal.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  registrationIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n  eventId: PropTypes.number.isRequired,\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/**\n * Download data generated locally or retrieved through AJAX as a file.\n *\n * @param {String} fileName\n * @param {String} data - Raw data obtained from the server\n */\nexport function downloadBlob(fileName, data) {\n  const blob = new Blob([data]);\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.href = url;\n  link.download = fileName;\n  document.body.append(link);\n  link.click();\n  link.remove();\n  URL.revokeObjectURL(url);\n}\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport React from 'react';\n\nimport {injectModal} from 'indico/react/util';\n\nimport PrintReceiptsModal from './printing/PrintReceiptsModal';\n\nwindow.printReceipts = function({\n  registration_id: registrationIds,\n  event_id: eventId,\n  reload_after: reloadAfter,\n}) {\n  injectModal(resolve => (\n    <PrintReceiptsModal\n      onClose={generated => {\n        if (generated && reloadAfter) {\n          location.reload();\n        } else {\n          resolve();\n        }\n      }}\n      registrationIds={registrationIds}\n      eventId={eventId}\n    />\n  ));\n};\n"],"names":["printReceiptsURL","_buildFlaskURL","bind","endpoint","rules","args","converters","event_id","template_id","defaults","trace","data","isDynamic","PrintingErrorsModal","_ref","onRetry","onClose","errors","open","setOpen","useState","React","Modal","closeIcon","Header","Translate","Content","Message","error","Table","celled","fixed","Row","HeaderCell","Body","map","_ref2","registration","undefineds","key","id","Cell","fullName","name","Label","color","Actions","ButtonGroup","Button","onClick","async","primary","Icon","propTypes","PropTypes","isRequired","firstName","lastName","allTemplatesURL","eventImagesURL","exportReceiptsURL","format","previewReceiptsURL","makeSubmitLabel","numRegistrants","publish","notify_users","notifyUsers","PluralTranslate","string","downloadOptions","value","text","archiveFilename","pdf","zip","PrintReceiptsModal","registrationIds","eventId","receiptIds","setReceiptIds","downloading","setDownloading","templateList","loading","useIndicoAxios","trigger","camelize","ready","downloadReceipts","downloadedData","indicoAxios","post","snakifyKeys","responseType","fileName","blob","Blob","link","document","createElement","url","URL","createObjectURL","href","download","body","append","click","remove","revokeObjectURL","downloadBlob","handleAxiosError","FinalModalForm","size","onSubmit","printedReceiptIds","values","printReceiptsRequest","registrations","force","template","templateId","_objectWithoutProperties","_excluded","registration_ids","receipt_ids","length","Promise","resolve","injectModal","resolveModal","retryData","Set","e","camelizeKeys","handleSubmitError","printReceipt","initialValues","custom_fields","document_type","filename","save_config","header","keepDirtyOnReinitialize","noSubmitButton","disabledAfterSubmit","fprops","count","Singular","Plural","Param","wrapper","Grid","columns","divided","Column","FinalDropdown","label","placeholder","options","_ref3","title","onChange","form","customFields","defaultFilename","find","t","change","Object","assign","f","getDefaultFieldValue","formatters","slugify","disabled","required","selection","Field","subscription","_ref4","input","FinalField","component","TemplateParameterEditor","_templateList$find","tpl","fetchImagesURL","defaultOpen","_ref5","FinalInput","type","componentLabel","labelPosition","v","replace","formatOnBlur","fluid","FinalCheckbox","description","_ref6","Form","Group","style","alignItems","FormSpy","_ref7","FinalSubmitButton","icon","width","Dropdown","scrolling","selectOnBlur","selectOnNavigation","_","_ref8","whiteSpace","marginLeft","_ref9","_ref10","Previewer","Segment","window","printReceipts","registration_id","reload_after","reloadAfter","generated","location","reload"],"sourceRoot":""}