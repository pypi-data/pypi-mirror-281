"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4098],{94348:(e,a,t)=>{var n=t(29079),i=t(78434),l=t.n(i),r=t(14867),s=t.n(r),d=t(97598),o=t.n(d),c=t(86326),m=t(35623),u=t(42430),f=t(6423),p=t(87597),y=t(56237),g=t(30319),E=t(89152),F=t(48404),b=t(96478),h=t(49528);const v=n.Ay.bind(null,{endpoint:"legal.display_privacy",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1}]}]},"/"),k=n.Ay.bind(null,{endpoint:"legal.display_tos",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tos",isDynamic:!1}]}]},"/");function w(e){let{cancelURL:a,moderated:t,tosUrl:n,tos:i,privacyPolicyUrl:r,privacyPolicy:d,termsRequireAccept:o,termsEffectiveDate:m,initialValues:w,hasPredefinedAffiliations:T,showAccountForm:q,syncedValues:_,emails:A,affiliationMeta:P,hasPendingUser:S,mandatoryFields:M,lockedFields:V,lockedFieldMessage:I}=e;const L=()=>{const e=e=>e.stopPropagation(),a=n?c.createElement("a",{href:k(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null),t=r?c.createElement("a",{href:v(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null);return(i||n)&&(d||r)?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"tosLink",wrapper:a},"terms of service")," ","and"," ",c.createElement(b.Param,{name:"privacyLink",wrapper:t},"privacy policy"),"."):i||n?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"tosLink",wrapper:a},"terms of service"),"."):d||r?c.createElement(b.Translate,null,"I have read, understood and accept the"," ",c.createElement(b.Param,{name:"privacyLink",wrapper:t},"privacy policy"),"."):void 0};return c.createElement(u.Form,{onSubmit:async(e,a)=>{const t=(0,E.getValuesForFields)(e,a);let n;delete t.password_confirm,T?t.affiliation_data&&(t.affiliation=t.affiliation_data.text.trim(),t.affiliation_id=t.affiliation_data.id,delete t.affiliation_data):delete t.affiliation_data;try{n=await h.indicoAxios.post(location.href,t)}catch(e){return(0,E.handleSubmitError)(e,T?{affiliation:"affiliation_data"}:{})}location.href=n.data.redirect,await new Promise((()=>{}))},initialValues:w,initialValuesEqual:l(),subscription:{submitting:!0},validate:e=>{const a={};return e.password&&e.password_confirm&&e.password_confirm!==e.password&&(a.password_confirm=b.Translate.string("Passwords must match")),a}},(e=>c.createElement(f.A,{onSubmit:e.handleSubmit},!q&&c.createElement(u.Field,{name:"synced_fields",isEqual:l(),render:()=>null}),S&&c.createElement(p.A,{info:!0},c.createElement(b.Translate,null,"There is already some information in Indico that concerns you. We are going to link it automatically.")),c.createElement(F.Fieldset,{legend:b.Translate.string("User information"),active:q||t},A.length>1?c.createElement(g.SyncedFinalDropdown,{name:"email",label:b.Translate.string("Email address"),options:A.map((e=>({key:e,value:e,text:e}))),syncedValues:_,lockedFields:V,lockedFieldMessage:I,required:!0}):c.createElement(g.SyncedFinalInput,{name:"email",label:b.Translate.string("Email address"),syncedValues:_,lockedFields:V,lockedFieldMessage:I,readOnly:!0}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(g.SyncedFinalInput,{name:"first_name",label:b.Translate.string("First name"),required:!0,syncedValues:_,lockedFields:V,lockedFieldMessage:I}),c.createElement(g.SyncedFinalInput,{name:"last_name",label:b.Translate.string("Last name"),required:!0,syncedValues:_,lockedFields:V,lockedFieldMessage:I})),T?c.createElement(g.SyncedFinalAffiliationDropdown,{name:"affiliation_data",required:t&&M.includes("affiliation"),syncName:"affiliation",syncedValues:_,lockedFields:V,lockedFieldMessage:I,currentAffiliation:P}):c.createElement(g.SyncedFinalInput,{name:"affiliation",label:b.Translate.string("Affiliation"),required:t&&M.includes("affiliation"),syncedValues:_,lockedFields:V,lockedFieldMessage:I}),"address"in _&&c.createElement(g.SyncedFinalTextArea,{name:"address",label:b.Translate.string("Address"),syncedValues:_,lockedFields:V,lockedFieldMessage:I}),"phone"in _&&c.createElement(g.SyncedFinalInput,{name:"phone",label:b.Translate.string("Phone number"),syncedValues:_,lockedFields:V,lockedFieldMessage:I})),q&&c.createElement(F.Fieldset,{legend:b.Translate.string("Login details")},c.createElement(E.FinalInput,{name:"username",label:b.Translate.string("Username"),required:!0}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(E.FinalInput,{name:"password",type:"password",label:b.Translate.string("Password"),autoComplete:"new-password",required:!0}),c.createElement(E.FinalInput,{name:"password_confirm",type:"password",label:b.Translate.string("Confirm password"),autoComplete:"new-password",required:!0}))),t&&c.createElement(F.Fieldset,{legend:b.Translate.string("Account moderation")},c.createElement(p.A,{info:!0},c.createElement(b.Translate,null,"Each new account needs to be approved by an administrator. We will send you an email as soon as your request has been approved.")),c.createElement(F.FinalTextArea,{required:M.includes("comment"),name:"comment",initialValue:"",label:b.Translate.string("Comment"),description:b.Translate.string("You can provide additional information or a comment for the administrators who will review your registration.")})),o&&!!i&&!n&&c.createElement(F.Fieldset,{legend:b.Translate.string("Terms of service")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:i}})),o&&!!d&&!r&&c.createElement(F.Fieldset,{legend:b.Translate.string("Privacy policy")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:d}})),o&&!!m&&c.createElement("div",{className:"field"},c.createElement(b.Translate,null,"Last updated"),": ",s()(m).format("LL")),o&&c.createElement(F.FinalCheckbox,{name:"accept_terms",required:!0,label:c.createElement("label",null,L())}),c.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},c.createElement(E.FinalSubmitButton,{disabledUntilChange:!1,label:t?b.Translate.string("Submit registration request"):b.Translate.string("Create my Indico profile"),className:"submit-button"}),c.createElement(f.A.Field,{disabled:e.submitting},c.createElement(y.A,{as:"a",href:a,disabled:e.submitting},c.createElement(b.Translate,null,"Cancel")))))))}w.propTypes={cancelURL:o().string.isRequired,moderated:o().bool.isRequired,tos:o().string,tosUrl:o().string,privacyPolicy:o().string,privacyPolicyUrl:o().string,termsRequireAccept:o().bool,termsEffectiveDate:o().string,initialValues:o().object.isRequired,hasPredefinedAffiliations:o().bool.isRequired,showAccountForm:o().bool.isRequired,syncedValues:o().object.isRequired,emails:o().arrayOf(o().string).isRequired,affiliationMeta:o().object,hasPendingUser:o().bool,mandatoryFields:o().arrayOf(o().string).isRequired,lockedFields:o().arrayOf(o().string),lockedFieldMessage:o().string},w.defaultProps={tos:"",tosUrl:"",privacyPolicy:"",privacyPolicyUrl:"",termsRequireAccept:!1,termsEffectiveDate:null,affiliationMeta:null,hasPendingUser:!1,lockedFields:[],lockedFieldMessage:""},document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#signup-container");if(!e)return;const a=JSON.parse(e.dataset.config);m.render(c.createElement(w,a),e)}))}},e=>{e.O(0,[4644,4394,2076],(()=>{return a=94348,e(e.s=a);var a}));e.O()}]);
//# sourceMappingURL=module_auth.signup.2076968a.bundle.js.map