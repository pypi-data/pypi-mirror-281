(self.webpackChunk=self.webpackChunk||[]).push([[3652],{23725:()=>{window.setupBadgePrinting=function(e){const t=$("#template"),n=$("#page_layout"),a=$("#dashed_border"),s=$("#page_size"),i=$("#page_orientation"),r=$(".margin-editor"),l=$(".info");function o(e,t,n){({A0:"A2",A1:"A3",A2:"A4",A3:"A5",A4:"A6",A5:"A7",A6:"A8"})[t]===e.format&&n===e.orientation?$("#page_layout option[value='foldable']").prop("disabled",!1):($("#page_layout option[value='foldable']").prop("disabled",!0),"foldable"===$("#page_layout :selected").val()&&$("#page_layout :selected").next().prop("selected",!0))}t.on("change",(function(){const t=$(this),a=e[parseInt(t.val(),10)];n.closest(".form-group").toggle(!!a.backside_tpl_id),n.val("front_only"),o(a,s.val(),i.val())})).change(),n.on("change",(function(){r.add(l).toggle("foldable"!==$(this).val()),a.closest(".form-group").toggle("foldable"!==$(this).val())})).change(),s.add(i).on("change",(function(){o(e[parseInt(t.val(),10)],s.val(),i.val()),n.change()})).change()}},93637:(e,t,n)=>{"use strict";var a=n(77940),s=n(13830),i=n.n(s),r=n(86326),l=n(35623),o=(n(35942),n(98778),n(23725),n(97598)),c=n.n(o),d=n(96478),m=n(29079),u=n(92117),g=n(56237),p=n(99323),_=n(23507),v=n(87597),y=n(59865),h=n(33864),f=n(43057),b=n(36111),E=n(89152),A=n(49528);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,b.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const T=m.Ay.bind(null,{endpoint:"persons.api_email_event_persons_metadata",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),C=m.Ay.bind(null,{endpoint:"persons.api_email_event_persons_send",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/"),j=m.Ay.bind(null,{endpoint:"persons.email_event_persons_preview",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/");function I(e){let{eventId:t,roleIds:n,persons:a,onClose:s,onSubmitSucceeded:i,noAccount:l,notInvitedOnly:o,successTimeout:c}=e;const[d,m]=(0,r.useState)(0),u={role_id:n,persons:a,no_account:l,not_invited_only:o},{data:g,loading:v}=(0,y.Ku)({url:T({event_id:t}),method:"POST",data:u}),{senders:f=[],recipients:b=[],subject:D,body:I,placeholders:k=[]}=g||{};return v?r.createElement(p.A,{active:!0,page:!0,inverted:!0},r.createElement(_.A,null)):r.createElement(h.V,{onSubmit:async e=>{const n=S(S({},e),u);let a;try{a=await A.indicoAxios.post(C({event_id:t}),n)}catch(e){return(0,E.handleSubmitError)(e)}m(a.data.count),i&&i(a.data.count),setTimeout((()=>s()),c)},onClose:s,senders:f,recipients:b,previewURL:j({event_id:t}),previewContext:u,placeholders:k,initialFormValues:{subject:D,body:I},sentEmailsCount:d})}I.propTypes={eventId:c().number.isRequired,roleIds:c().arrayOf(c().number),persons:c().arrayOf(c().string),onClose:c().func.isRequired,onSubmitSucceeded:c().func,noAccount:c().bool,notInvitedOnly:c().bool,successTimeout:c().number},I.defaultProps={roleIds:[],persons:[],onSubmitSucceeded:void 0,noAccount:!1,notInvitedOnly:!1,successTimeout:5e3};var k=n(79106);const R=["eventId","roleId","persons","personSelector","triggerSelector","noAccount","notInvitedOnly","onSubmitSucceeded","successTimeout"];function w(e){let{eventId:t,roleId:n,persons:s,personSelector:i,triggerSelector:l,noAccount:o,notInvitedOnly:c,onSubmitSucceeded:m,successTimeout:u}=e,p=(0,f.A)(e,R);const[_,v]=(0,r.useState)(!1);return s=i?(0,k.r)(i,!1):s,(0,r.useEffect)((()=>{if(!l)return;const e=()=>v(!0),t=document.querySelector(l);return t.addEventListener("click",e),()=>t.removeEventListener("click",e)}),[l]),r.createElement(r.Fragment,null,!l&&r.createElement(g.A,(0,a.A)({onClick:()=>v(!0),disabled:!(n||s.length)},p),r.createElement(d.Translate,null,"Send email")),_&&r.createElement(I,{eventId:t,roleIds:n&&[n],persons:s,noAccount:o,notInvitedOnly:c,onClose:()=>v(!1),onSubmitSucceeded:m,successTimeout:u}))}w.propTypes={eventId:c().number.isRequired,roleId:c().number,persons:c().arrayOf(c().string),personSelector:c().string,triggerSelector:c().string,noAccount:c().bool,notInvitedOnly:c().bool,onSubmitSucceeded:c().func,successTimeout:c().number},w.defaultProps={roleId:void 0,persons:[],personSelector:void 0,triggerSelector:void 0,noAccount:!1,notInvitedOnly:!1,onSubmitSucceeded:void 0,successTimeout:void 0};var q=n(87493),O=n.n(q),x=n(6841),N=n(91185),M=n(16520),P=n(47279);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,b.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const U=e=>O()(e,"identifier");function H(e,t){return"CHANGE_SORT"===t.type?e.column!==t.column?{column:t.column,sortedPersons:U(e.sortedPersons).sort(((e,n)=>e[t.column].localeCompare(n[t.column]))),direction:"ascending"}:"ascending"===e.direction?{column:e.column,sortedPersons:e.sortedPersons.slice().reverse(),direction:"descending"}:{column:null,sortedPersons:U(e.sortedPersons),direction:null}:e}const z=e=>{let{primaryAuthor:t,secondaryAuthor:n}=e;return[t&&d.Translate.string("Primary"),n&&d.Translate.string("Co-author")].filter((e=>e)).join(", ")||"-"};function B(e){let{persons:t,selectedPersons:n,onChangeSelection:a,isSelectable:s,isVisible:i,extraRoles:l}=e;const[o,c]=(0,r.useReducer)(H,{column:null,sortedPersons:U(t).map((e=>F(F({},e),{},{authorType:z(e),selectable:s(e)}))),direction:null}),{column:m,sortedPersons:u,direction:g}=o,p=u.filter((e=>i(e))),_=p.filter((e=>e.selectable)),v=n.filter((e=>i(t.find((t=>t.identifier===e))))).length,y=[...l,{icon:"mic",isActive:e=>e.speaker,titleActive:d.Translate.string("This person is a speaker"),titleInactive:d.Translate.string("This person is not a speaker")}];return r.createElement(x.A,{sortable:!0,selectable:!0,singleLine:!0},r.createElement(x.A.Header,null,r.createElement(x.A.Row,null,r.createElement(x.A.HeaderCell,{disabled:!0,colSpan:"2"},r.createElement(N.A,{indeterminate:v>0&&v<_.length,checked:v>0&&v===_.length,onChange:(e,t)=>{return n=t.checked,void a(n?_.map((e=>e.identifier)):[]);var n},disabled:!_.length})),r.createElement(d.Translate,{as:x.A.HeaderCell,sorted:"fullName"===m?g:null,onClick:()=>c({type:"CHANGE_SORT",column:"fullName"})},"Name"),r.createElement(d.Translate,{as:x.A.HeaderCell,sorted:"email"===m?g:null,onClick:()=>c({type:"CHANGE_SORT",column:"email"})},"Email"),r.createElement(d.Translate,{as:x.A.HeaderCell,sorted:"affiliation"===m?g:null,onClick:()=>c({type:"CHANGE_SORT",column:"affiliation"})},"Affiliation"),r.createElement(d.Translate,{as:x.A.HeaderCell,sorted:"authorType"===m?g:null,onClick:()=>c({type:"CHANGE_SORT",column:"authorType"})},"Author type"),r.createElement(d.Translate,{as:x.A.HeaderCell,disabled:!0},"Roles"))),r.createElement(x.A.Body,null,p.map((e=>r.createElement(x.A.Row,{key:e.identifier,style:e.selectable?{}:{opacity:"50%"},onClick:()=>(e=>{let{identifier:t,selectable:s}=e;s&&(n.includes(t)?a(n.filter((e=>e!==t))):a([...n,t]))})(e)},r.createElement(x.A.Cell,{collapsing:!0},r.createElement(N.A,{disabled:!e.selectable,checked:n.includes(e.identifier)})),r.createElement(x.A.Cell,{collapsing:!0},r.createElement(M.A,{content:e.registered?d.Translate.string("This person is registered for the event"):d.Translate.string("This person is not yet registered"),position:"bottom center",inverted:!0,trigger:r.createElement("i",{className:"icon-ticket "+(e.registered?"":"inactive")})})),r.createElement(x.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.fullName),r.createElement(x.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.email),r.createElement(x.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.affiliation),r.createElement(x.A.Cell,{collapsing:!0},e.authorType),r.createElement(x.A.Cell,{collapsing:!0},y.map((t=>{let{icon:n,isActive:a,titleActive:s,titleInactive:i}=t;return r.createElement(M.A,{key:n,content:a(e)?s:i,position:"bottom center",inverted:!0,trigger:r.createElement("i",{key:n,className:`icon-${n} ${a(e)?"":"inactive"}`})})})))))),!p.length&&r.createElement(x.A.Row,{warning:!0},r.createElement(x.A.Cell,{colSpan:"7"},r.createElement(P.A,{name:"attention"}),r.createElement(d.Translate,null,"No persons were found matching the selected criteria.")))))}B.propTypes={persons:c().arrayOf(c().shape({identifier:c().string.isRequired,fullName:c().string.isRequired,email:c().string.isRequired,affiliation:c().string.isRequired,speaker:c().bool.isRequired,primaryAuthor:c().bool.isRequired,secondaryAuthor:c().bool.isRequired,registered:c().bool.isRequired})).isRequired,selectedPersons:c().arrayOf(c().string).isRequired,onChangeSelection:c().func.isRequired,isSelectable:c().func,isVisible:c().func,extraRoles:c().arrayOf(c().shape({icon:c().string.isRequired,isActive:c().func.isRequired,titleActive:c().string.isRequired,titleInactive:c().string.isRequired}))},B.defaultProps={isSelectable:()=>!0,isVisible:()=>!0,extraRoles:[]};const V=m.Ay.bind(null,{endpoint:"abstracts.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"abstracts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),K=m.Ay.bind(null,{endpoint:"contributions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),Q=m.Ay.bind(null,{endpoint:"sessions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sessions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),G={abstracts:{idType:"abstract_id",personListURL:V},contributions:{idType:"contribution_id",personListURL:K,emptyListMessage:d.Translate.string("There are no persons associated with the selected contributions")},sessions:{idType:"session_id",personListURL:Q,emptyListMessage:d.Translate.string("There are no persons associated with contributions in the selected sessions")}},W={submitter:{text:d.Translate.string("Submitters"),isMatch:e=>e.submitter,contexts:["abstracts"]},speaker:{text:d.Translate.string("Speakers"),isMatch:e=>e.speaker},primaryAuthor:{text:d.Translate.string("Primary authors"),isMatch:e=>e.primaryAuthor},secondaryAuthor:{text:d.Translate.string("Co-authors"),isMatch:e=>e.secondaryAuthor},notRegistered:{text:d.Translate.string("Not registered"),isMatch:e=>!e.registered}};function X(e){let{eventId:t,sourceIds:n,objectContext:a,onClose:s}=e;const[i,l]=(0,r.useState)([]),[o,c]=(0,r.useState)(void 0),[m,f]=(0,r.useState)([]),b=new FormData;n.forEach((e=>b.append(G[a].idType,e)));const{data:E,loading:A}=(0,y.Ku)({url:G[a].personListURL({event_id:t}),method:"POST",data:b,headers:{"content-type":"multipart/form-data"}},{camelize:!0}),D="abstracts"===a?[{icon:"user-check icon",isActive:e=>e.submitter,titleActive:d.Translate.string("This person submitted an abstract"),titleInactive:d.Translate.string("This person hasn't submitted any abstracts")}]:void 0,S=e=>!m.length||m.some((t=>W[t].isMatch(e))),T=Object.entries(W).filter((e=>{let[,t]=e;return!t.contexts||t.contexts.includes(a)})).map((e=>{let[t,n]=e;return{key:t,content:n.text,onClick:()=>(e=>{f(m.includes(e)?m.filter((t=>t!==e)):[...m,e])})(t),primary:m.includes(t)}}));return r.createElement(u.A,{open:!0,onClose:()=>s(),size:"large"},r.createElement(u.A.Header,{content:d.Translate.string("Authors list")}),r.createElement(u.A.Content,null,o&&r.createElement(h.M,{count:o}),r.createElement("div",null,r.createElement(d.Translate,{as:"div",style:{display:"inline-block",fontWeight:"bold",padding:"0.5em"}},"Filter by"),r.createElement(g.A.Group,{buttons:T,compact:!0})),A||!E?r.createElement(p.A,{active:!0},r.createElement(_.A,null)):Object.keys(E.eventPersons).length?r.createElement(B,{persons:Object.values(E.eventPersons),selectedPersons:i,onChangeSelection:e=>l(e),isSelectable:e=>!!e.email,isVisible:S,extraRoles:D}):r.createElement(v.A,{error:!0},G[a].emptyListMessage)),r.createElement(u.A.Actions,null,r.createElement(w,{eventId:t,persons:i.filter((e=>S(E.eventPersons[e]))),onSubmitSucceeded:e=>c(e),successTimeout:0,primary:!0}),r.createElement(d.Translate,{as:g.A,onClick:()=>s()},"Close")))}function Z(e){let{eventId:t,objectContext:n,paramsSelector:a}=e;const[s,i]=(0,r.useState)(!1),l=(0,k.r)(a);return r.createElement(r.Fragment,null,r.createElement("button",{type:"button",className:"i-button icon-users js-requires-selected-row disabled",onClick:e=>{e.target.classList.contains("disabled")||i(!0)}},r.createElement(d.Translate,null,"Authors list")),s&&r.createElement(X,{eventId:t,sourceIds:l,objectContext:n,onClose:()=>i(!1)}))}X.propTypes={eventId:c().number.isRequired,sourceIds:c().arrayOf(c().number).isRequired,objectContext:c().oneOf(Object.keys(G)).isRequired,onClose:c().func.isRequired},Z.propTypes={eventId:c().number.isRequired,objectContext:c().oneOf(Object.keys(G)).isRequired,paramsSelector:c().string.isRequired};var Y=n(94440),J=n(25584),ee=n(24720),te=n(8196),ne=n(78434),ae=n.n(ne),se=n(14867),ie=n.n(se),re=n(503),le=n(49138),oe=n(53225),ce=n(68820),de=n(63173),me=n(98727);const ue={"evt-list":"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH","evt-item":"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a",detail:"events-management-client-js-___SeriesManagement-module__detail___mXZyy","delete-button":"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH","list-flex":"events-management-client-js-___SeriesManagement-module__list-flex___DE65m",disabled:"events-management-client-js-___SeriesManagement-module__disabled___CB78C","date-span":"events-management-client-js-___SeriesManagement-module__date-span___8yRl2","category-chain":"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv","event-title":"events-management-client-js-___SeriesManagement-module__event-title___961dm","warning-reason":"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ","positive-note":"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv","load-more":"events-management-client-js-___SeriesManagement-module__load-more___6T2U4"},ge=m.Ay.bind(null,{endpoint:"categories.event_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"events",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search-for-series",isDynamic:!1}]}]},"/"),pe=m.Ay.bind(null,{endpoint:"event_series.event_series",rules:[{args:["series_id"],converters:{series_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1},{data:"series_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),_e=m.Ay.bind(null,{endpoint:"events.single_event_api",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"info-for-series",isDynamic:!1}]}]},"/"),ve=(0,me.q)(250),ye=(0,me.q)(250);function he(e){let{eventId:t,categoryId:n,seriesId:a,timezone:s}=e;const i=null!==a,[l,o]=(0,r.useState)(!1),{loading:c,reFetch:m,data:u}=(0,y.Ku)(i?pe({series_id:a}):_e({event_id:t}),{manual:!0}),g=async()=>{await m(),o(!0)},v=u?i?u:{id:null,events:[u],show_sequence_in_title:!1,show_links:!1,event_title_pattern:""}:null;return r.createElement(r.Fragment,null,i?r.createElement(ce.IButton,{borderless:!0,icon:"stack",title:d.Translate.string("Manage event series"),onClick:g},r.createElement(d.Translate,null,"Manage series")):r.createElement(ce.IButton,{borderless:!0,icon:"stack",title:d.Translate.string("Create event series"),onClick:g},r.createElement(d.Translate,null,"Create series")),r.createElement(p.A,{active:c,page:!0,inverted:!0},r.createElement(_.A,null)),l&&r.createElement(fe,{currentEventId:t,categoryId:n,timezone:s,series:v,onClose:()=>{o(!1)}}))}function fe(e){let{currentEventId:t,categoryId:n,series:a,timezone:s,onClose:i}=e;const[l,o]=(0,r.useState)(!1),c=null!==a.id,m=e=>ie()(e).tz(s);return r.createElement(r.Fragment,null,r.createElement(de.Sz,{id:"event-series",header:c?d.Translate.string("Manage series"):d.Translate.string("Create series"),size:"standard",alignTop:!0,onSubmit:async(e,t)=>{const n=c?(0,de.bW)(e,t):(0,de.Pj)(e,t);n.events&&(n.event_ids=n.events.map((e=>e.id)),delete n.events);try{c?await A.indicoAxios.patch(pe({series_id:a.id}),n):await A.indicoAxios.post(pe(),n)}catch(e){return(0,E.handleSubmitError)(e,{event_ids:"events"})}location.reload(),await new Promise((()=>{}))},onClose:i,initialValues:a,disabledUntilChange:c,extraActions:e=>c&&r.createElement(g.A,{style:{marginRight:"auto"},onClick:()=>o(!0),disabled:e.submitting,negative:!0},r.createElement(d.Translate,null,"Delete series")),submitLabel:c?d.Translate.string("Update series"):d.Translate.string("Create series")},(()=>r.createElement(r.Fragment,null,r.createElement(E.FinalField,{name:"events",isEqual:(e,t)=>ae()((e||[]).map((e=>e.id)),(t||[]).map((e=>e.id))),validate:e=>{if(!e.length)return d.Translate.string("A series needs to contain at least one event.")},component:be,localMoment:m,categoryId:n,currentEventId:t,existingSeriesId:a.id,divider:r.createElement(re.A,{horizontal:!0},c?r.createElement(d.Translate,null,"Events in series"):r.createElement(d.Translate,null,"Events to add"))}),r.createElement(re.A,{horizontal:!0},r.createElement(d.Translate,null,"Series options")),r.createElement(E.FinalCheckbox,{name:"show_sequence_in_title",label:d.Translate.string("Show the sequence number in the event titles (lectures only)")}),r.createElement(E.FinalCheckbox,{name:"show_links",label:d.Translate.string("Show links to the other events of the series on the main event page")}),r.createElement(E.FinalInput,{name:"event_title_pattern",label:d.Translate.string("Event title pattern"),description:r.createElement(d.Translate,null,"Title pattern for cloned events. Must contain the"," ",r.createElement(d.Param,{name:"placeholder",wrapper:r.createElement("code",null),value:"{n}"})," placeholder which will indicate the new event's position in the series."),validate:e=>{if(e&&!e.includes("{n}"))return d.Translate.string("Title pattern must contain the {placeholder} placeholder",{placeholder:"{n}"})}})))),r.createElement(ce.RequestConfirmDelete,{open:l,onClose:()=>o(!1),requestFunc:async()=>{try{await A.indicoAxios.delete(pe({series_id:a.id}))}catch(e){return(0,A.handleAxiosError)(e),!0}location.reload()},persistent:!0},r.createElement(d.Translate,null,"Do you really want to delete this series? The associated events will not be deleted.")))}function be(e){let{value:t,onChange:n,onFocus:a,onBlur:s,divider:i,localMoment:l,categoryId:o,currentEventId:c,existingSeriesId:m}=e;const[u,p]=(0,r.useState)(void 0),[_,v]=(0,r.useState)([]),[y,h]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[E,D]=(0,r.useState)(null),S=null!==m,T=async e=>{let t;try{t=await ye((()=>A.indicoAxios.get(_e({event_id:+e}))))}catch(e){return void(0,A.handleAxiosError)(e)}if(null===t.data)D(d.Translate.string("No event found with this ID."));else if(t.data.can_access){if(t.data.category_chain)return v([t.data]),D(null),void b(!1);D(d.Translate.string("This event is unlisted."))}else D(d.Translate.string("You don't have rights to access this event."));b(!1),v([])},C=async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t=await ve((()=>A.indicoAxios.get(ge({category_id:o,q:e,offset:n}))))}catch(e){return void(0,A.handleAxiosError)(e)}v(a?[..._,...t.data.events]:t.data.events),h(t.data.has_more),D(null),b(!1)},j=new Set(t.map((e=>e.id)));let I=_.map((e=>({key:e.id,value:e.id,text:e.title,disabled:!e.can_manage||!e.category_chain||e.series_id!==m&&null!==e.series_id||j.has(e.id),content:r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},l(e.start_dt).format("ll")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(ce.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv"},e.category_chain?e.category_chain.join(" » "):r.createElement(d.Translate,null,"Unlisted"))),!e.can_manage&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"You do not have editing rights for this event.")),!e.category_chain&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is unlisted.")),e.series_id!==m&&null!==e.series_id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is already part of a different series.")),j.has(e.id)&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is already part of this series."))))})));const k=()=>{b(!0),C(u.trim(),_.length,!0)};return I.length>0&&y&&(I=[...I,{key:"_",value:"_",className:ue["load-more"],content:r.createElement("div",{onClick:e=>{e.stopPropagation()}},r.createElement(g.A,{primary:!0,compact:!0,size:"small",type:"button",loading:f,onClick:k},r.createElement(d.Translate,null,"Load more")))}]),r.createElement(r.Fragment,null,r.createElement(le.A,{fluid:!0,selection:!0,search:e=>e,icon:"search",closeOnChange:!1,selectOnBlur:!1,selectOnNavigation:!1,placeholder:d.Translate.string("Search for an event title or paste an event URL or event ID (#123)"),options:I,value:null,loading:f,onSearchChange:async(e,t)=>{let{searchQuery:n}=t;if(h(!1),p(n),n=n.trim(),D(null),!n)return b(!1),void v([]);const a=new RegExp(`^${location.origin.replace("/","\\/")}\\/event\\/([0-9]+)`),s=n.match(a);s?(b(!0),T(s[1])):/^#([0-9])+$/.test(n)?(b(!0),T(n.substr(1))):"#"!==n&&(b(!0),C(n))},searchQuery:u,onChange:(e,a)=>{let{value:s}=a;if("_"===s)return;const i=_.find((e=>e.id===s)),r=[...t,i].sort(((e,t)=>ie()(e.start_dt)-ie()(t.start_dt)));n(r)},onFocus:a,onBlur:s,noResultsMessage:f?d.Translate.string("Searching..."):null!==E?E:u?d.Translate.string("No results found."):d.Translate.string("Enter search term")}),i,r.createElement(oe.A,{divided:!0,relaxed:!0,className:"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH"},t.map((e=>r.createElement(oe.A.Item,{key:e.id,className:"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a"},r.createElement(oe.A.Content,null,r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},l(e.start_dt).format("ll"),r.createElement("br",null),c===e.id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},"(",r.createElement(d.Translate,null,"this event"),")")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(ce.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__detail___mXZyy"},e.category_chain?e.category_chain.join(" » "):r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement(d.Translate,null,"Unlisted"))))),(c!==e.id||S)&&r.createElement(M.A,{trigger:r.createElement(P.A,{className:"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH",name:"close",onClick:()=>{a(),s(),n(t.filter((t=>t.id!==e.id)))},link:!0}),content:d.Translate.string("Remove from event series"),position:"bottom center"}))))))))}he.propTypes={eventId:c().number.isRequired,categoryId:c().number.isRequired,timezone:c().string.isRequired,seriesId:c().number},he.defaultProps={seriesId:null},fe.propTypes={currentEventId:c().number.isRequired,categoryId:c().number.isRequired,series:c().shape({id:c().number,events:c().arrayOf(c().object).isRequired,show_sequence_in_title:c().bool.isRequired,show_links:c().bool.isRequired,event_title_pattern:c().string.isRequired}).isRequired,timezone:c().string.isRequired,onClose:c().func.isRequired},be.propTypes={value:c().arrayOf(c().object).isRequired,onChange:c().func.isRequired,divider:c().node.isRequired,localMoment:c().func.isRequired,categoryId:c().number.isRequired,currentEventId:c().number.isRequired,existingSeriesId:c().number,onFocus:c().func.isRequired,onBlur:c().func.isRequired},be.defaultProps={existingSeriesId:null},function(e){function t(){$("#person-filters ul > li").removeClass("enabled");const e=$(".js-event-person-list tr[data-person-roles]"),t=$(".js-event-person-list [data-filter]:checked").map((function(){const e=$(this);return e.closest("li").addClass("enabled"),e.data("filter")})).get(),n=e.filter(((e,n)=>!t.length||t.find((e=>$(n).data("person-roles")[e]))));e.addClass("hidden"),n.removeClass("hidden"),$(".js-event-person-list").trigger("indico:syncEnableIfChecked")}function n(){$(".js-reset-role-filter").toggleClass("disabled",0===$("#person-filters [data-filter]:checked").length)}function s(){$(".js-show-regforms").qtip({content:{text(){return $(this).data("title")}},hide:{delay:100,fixed:!0}})}e.setupEmailButton=function(e,t){const n=document.querySelector(e),{eventId:s,roleId:i,personSelector:o}=n.dataset,c={};void 0!==n.dataset.noAccount&&(c.noAccount=!0),void 0!==n.dataset.notInvitedOnly&&(c.notInvitedOnly=!0),l.render(r.createElement(w,(0,a.A)({eventId:+s,roleId:i&&+i,personSelector:o,triggerSelector:t},c)),n)},e.setupEmailContribAbstractRoles=function(e){const t=document.querySelector(e),{objectContext:n,idSelector:a,metadataUrl:s,previewUrl:i,sendUrl:o}=t.dataset;l.render(r.createElement(Y.L,{objectContext:n,idSelector:a,metadataURL:s,previewURL:i,sendURL:o,className:"js-requires-selected-row disabled"}),t)},e.setupAuthorsListButton=function(e){const t=document.querySelector(e),{eventId:n,objectContext:a,paramsSelector:s}=t.dataset;l.render(r.createElement(Z,{eventId:+n,objectContext:a,paramsSelector:s}),t)},e.setupEventManagementActionMenu=function(){const e=document.querySelector("#event-action-move-container");e&&l.render(r.createElement(te.wu,{eventId:+e.dataset.eventId,currentCategoryId:+e.dataset.categoryId,hasPendingMoveRequest:void 0!==e.dataset.pendingRequest}),e);const t=document.querySelector("#event-action-manage-series-container");if(t){const e=void 0!==t.dataset.seriesId?+t.dataset.seriesId:null;l.render(r.createElement(he,{eventId:+t.dataset.eventId,categoryId:+t.dataset.categoryId,timezone:t.dataset.timezone,seriesId:e}),t)}const n=document.querySelector("#event-action-publish-container");n&&l.render(r.createElement(te.eT,{eventId:+n.dataset.eventId,hasPendingPublishRequest:void 0!==n.dataset.pendingRequest}),n),$("#event-action-menu-clones-target").qbubble({content:{text:$("#event-action-menu-clones")}}),$("#event-action-menu-actions-target").qbubble({content:{text:$("#event-action-menu-actions")},style:{classes:"qtip-allow-overflow"}});$(["#event-action-menu-actions button:not(.js-dropdown)","#event-action-menu-actions a:not(.disabled)"].join(", ")).on("click",(function(){$("#event-action-menu-actions-target").qbubble("hide")}))},e.setupEventPersonsList=function(e){e=$.extend({hasNoAccountFilter:!1,hasNoRegistrationFilter:!1,hasNoBuiltinRolesFilter:!1},e);const a=setupSearchBox({itemHandle:"tr",listItems:"#event-participants-list tbody tr:not(.hidden)",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"});enableIfChecked(".js-event-person-list",".select-row:visible",".js-event-person-list .js-requires-selected-row"),$(".js-event-person-list").closest(".ui-dialog").length&&$(".js-event-person-list [data-toggle=dropdown]").closest(".toolbar").dropdown(),$(".js-event-person-list [data-filter]").on("click",t),$(".js-event-person-list td").on("mouseenter",(function(){const e=$(this);this.offsetWidth<this.scrollWidth&&!e.attr("title")&&!e.find(".js-popup-container").length&&e.attr("title",e.text())})),$(".js-event-person-list .tablesorter").tablesorter({cssAsc:"header-sort-asc",cssDesc:"header-sort-desc",headerTemplate:"",sortList:[[1,0]]});const r=$(".js-event-person-list .roles-column > span");r.qbubble({show:{event:"mouseover"},hide:{fixed:!0,delay:100,event:"mouseleave"},position:{my:"left center",at:"right center"},content:{text(){const e=$(this),t=$("<div>"),n=$("<strong>",{text:$(this).data("role-name")});if(t.append(n),e.is(".js-count-label")){const n=$("<ul>",{class:"qbubble-item-list"}),a=i()(e.data("items")).sort((function(e,t){return(0,ee.v)(e.title.toLowerCase(),t.title.toLowerCase())}));$.each(a,(function(){const e=$("<li>");this.url?e.append($("<a>",{text:this.title,href:this.url})):e.text(this.title),n.append(e)})),t.append(n)}return t}}}),r.filter(".custom").each((function(){const e=$(this);e.css("background-color",$.Color(e.css("color")).alpha(.1))})),e.hasNoAccountFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-account)").on("change",(function(){$("#filter-no-account").prop("checked",!1),t(),a()})),$("#filter-no-account").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-account)").prop("checked",!1),t(),a()}))),e.hasNoRegistrationFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-registration)").on("change",(function(){$("#filter-no-registration").prop("checked",!1),t(),a()})),$("#filter-no-registration").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-registration)").prop("checked",!1),t(),a()}))),e.hasNoBuiltinRolesFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-builtin-roles)").on("change",(function(){$("#filter-no-builtin-roles").prop("checked",!1),t(),a()})),$("#filter-no-builtin-roles").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-builtin-roles)").prop("checked",!1),t(),a()}))),s();const l=$("#person-filters");l.find("li .colored-square").each((function(){const e=$(this);e.closest("li").css("background-color",$.Color(e.css("color")).alpha(.1))})),l.find(".js-reset-role-filter").on("click",(function(){$(".js-event-person-list [data-filter]").each((function(){const e=$(this);e.prop("checked",!1),e.parent().toggleClass("enabled",!1)})),t(),a(),n()})),l.find("li label").on("click",(function(e){e.preventDefault()})),l.find("li").on("click",(function(){const e=$(this).find("[data-filter]");e.prop("checked",!e.prop("checked")).trigger("change"),n()})),$("#event-participants-list").on("indico:htmlUpdated",s)},e.showUndoWarning=function(e,t,n){cornerMessage({message:e,progressMessage:J.$T.gettext("Undoing previous operation..."),feedbackMessage:t,actionLabel:J.$T.gettext("Undo"),actionCallback:n,duration:1e4,feedbackDuration:4e3,class:"warning"})},e.handleSelectedRowHighlight=function(e){const t=$("table.i-table input.select-row").on("change",(function(){$(this).closest("tr").toggleClass("selected",this.checked)}));e&&t.trigger("change")},e.showThemeSettingsForm=function(e){e=$.extend(!0,{formUrl:null,themeFieldId:null,lastFieldId:null},e),$(`#${e.themeFieldId}`).on("change",(function(){$.ajax({url:e.formUrl,data:{theme:$(this).val()},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(t){const n=$(`#${e.lastFieldId}`);n.nextAll(":not(.form-group-footer)").remove(),t.html&&n.after(t.html),t.js&&$("body").append(t.js)}})}))}}(window)}},e=>{e.O(0,[4644,4394,2076],(()=>{return t=93637,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.management.647b21c7.bundle.js.map