(()=>{"use strict";var t,n={4215:(t,n,e)=>{var o=e(9722),i=e(6252),a=e(2262),r=e(3577),c=e(5762),l=e(830),u=e(885),s=e(5861),f=e(4687),d=e.n(f),p=e(4967);function m(t,n){return{markRead:(o=(0,s.Z)(d().mark((function t(n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.Z.notifications.markRead(n);case 3:this.collection=this.collection.filter((function(t){return t.id!==n.id})),this.collectionMetaData.total_entries-=1,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return o.apply(this,arguments)}),postPone:(e=(0,s.Z)(d().mark((function t(n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.Z.notifications.postPone(n);case 3:this.collection=this.collection.filter((function(t){return t.id!==n.id})),this.collectionMetaData.total_entries-=1,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return e.apply(this,arguments)}),handleError:function(t){var n=this;return(0,s.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.loading=!1,n.error=t,e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})))()},loadChannel:function(){var t=arguments,e=this;return(0,s.Z)(d().mark((function o(){var i,a,r;return d().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:5,console.log("Calling loadChannel"),e.loading=!0,o.prev=3,o.next=7,p.Z.notifications.loadCollection({fields:["title","body"],related:[],pageOptions:{items_per_page:i,page:0},filters:{channel:n}});case 7:a=o.sent,r=(0,u.Z)(a,2),e.collectionMetaData=r[0],e.collection=r[1],e.loading=!1,e.error="",o.next=18;break;case 15:throw o.prev=15,o.t0=o.catch(3),new Error(o.t0);case 18:case"end":return o.stop()}}),o,null,[[3,15]])})))()}};var e,o}var _=function(t,n){return(0,l.Q_)(t,{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{total_entries:0}}},actions:m(0,n),getters:{notificationCount:function(t){return t.collectionMetaData.total_entries}}})},v=_("notification-message","message"),h=_("notification-header_message","header_message"),b=_("notification-alert","alert"),k=e(2037),g={class:"icon",role:"presentation"},w=["innerHTML"],y=["innerHTML"];const M={__name:"Notification",props:{notification:Object},emits:["mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,c=e,l={success:"check",valid:"check-circle",error:"exclamation-triangle",invalid:"times-circle",caution:"exclamation-triangle",neutral:"info-circle",calendar:"calendar-alt"}[o.notification.status_type]||"info-circle",u={success:"success",valid:"success",error:"invalid",caution:"caution",neutral:"neutral",calendar:"neutral"}[o.notification.status_type]||"neutral",s=function(){c("postpone",o.notification)},f=function(){c("mark_read",o.notification)};return function(n,e){return(0,i.wg)(),(0,i.iD)("li",{"aria-hidden":"false",class:(0,r.C_)((0,a.SU)(u))},[(0,i._)("span",g,[(0,i.Wm)(k.Z,{name:(0,a.SU)(l)},null,8,["name"])]),(0,i._)("div",null,[(0,i._)("h4",{class:"text",innerHTML:t.notification.title},null,8,w),(0,i._)("div",{class:"text",innerHTML:t.notification.body},null,8,y)]),(0,i._)("button",{class:"icon unstyled close",title:"Fermer cette notification","aria-label":"Fermer cette notification",onClick:f},[(0,i.Wm)(k.Z,{name:"times"})]),(0,i._)("button",{class:"icon unstyled repeat",title:"Répéter cette notification dans 7 jours","aria-label":"Répéter cette notification dans 7 jours",onClick:s},[(0,i.Wm)(k.Z,{name:"clock"})])],2)}}};var C={class:"notifications"},S={key:0,class:"text_more"},j=(0,i._)("br",null,null,-1);const x={__name:"NotificationList",props:{notifications:Array,notificationCount:Number},emits:["showAll","mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,c=e,l=Math.max(o.notificationCount-5,0),u="... et ".concat(l," autres notifications"),s=function(){return c("showAll"),!1};return function(n,e){return(0,i.wg)(),(0,i.iD)("ul",C,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.notifications.slice(0,(0,a.SU)(5)),(function(t){return(0,i.wg)(),(0,i.j4)(M,{key:t.id,notification:t,onMark_read:function(t){return n.$emit("mark_read",t)},onPostpone:function(t){return n.$emit("postpone",t)}},null,8,["notification","onMark_read","onPostpone"])})),128)),(0,a.SU)(l)?((0,i.wg)(),(0,i.iD)("li",S,[(0,i._)("div",null,[(0,i._)("small",null,(0,r.zw)(u)),j,(0,i._)("a",{href:"javascript:void(0);",onClick:s},"Voir toutes les notifications")])])):(0,i.kq)("v-if",!0)])}}};var D=["id","aria-labelledby"],U={class:"modal_layout"},H=["id"],P={class:"modal_content_layout"},O={class:"modal_content"};const T={__name:"ModalLayout",props:{size:{type:String,default:"middle"}},emits:["close"],setup:function(t,n){var e=t,c=n.emit,l=(0,o.EL)(),u="modal_view size_"+e.size;return function(t,n){return(0,i.wg)(),(0,i.iD)("section",{class:(0,r.C_)(u)},[(0,i._)("div",{role:"dialog",id:(0,a.SU)(l),"aria-modal":"true","aria-labelledby":"modal"+(0,a.SU)(l)+"_title",class:"appear"},[(0,i._)("div",U,[(0,i._)("header",null,[(0,i._)("button",{type:"button",class:"icon only unstyled close",title:"Masquer cette fenêtre","aria-label":"Masquer cette fenêtre",onClick:n[0]||(n[0]=function(){return c("close")})},[(0,i.Wm)(k.Z,{name:"times"})]),(0,i._)("h2",{id:"modal"+(0,a.SU)(l)+"_title"},[(0,i.WI)(t.$slots,"header")],8,H)]),(0,i._)("div",P,[(0,i._)("div",O,[(0,i.WI)(t.$slots,"body")]),(0,i._)("footer",null,[(0,i.WI)(t.$slots,"footer")])])])],8,D)])}}};var Z={class:"notifications"};const L={__name:"NotificationModal",emits:["close","mark_read","postpone"],setup:function(t,n){return(0,s.Z)(d().mark((function t(){var e,o,s,f,p,m,_,h,b,k,g,w;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.emit,m=s,_=v(),(h=(0,l.Jk)(_)).collectionMetaData,b=h.collection,k=(0,a.iH)(null),(0,c.i9H)(k,(function(t){m("close")})),g=function(t){m("mark_read",t)},w=function(t){m("postpone",t)},e=(0,i.mv)((function(){return _.loadChannel(1e3)})),o=(0,u.Z)(e,2),f=o[0],p=o[1],t.next=11,f;case 11:return p(),t.abrupt("return",(function(t,n){return(0,i.wg)(),(0,i.j4)(T,{onClose:n[1]||(n[1]=function(n){return t.$emit("close")}),ref_key:"modalTarget",ref:k},{header:(0,i.w5)((function(){return[(0,i.Uk)((0,r.zw)((0,a.SU)(b).length)+" Notifications",1)]})),body:(0,i.w5)((function(){return[(0,i._)("ul",Z,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,a.SU)(b),(function(t){return(0,i.wg)(),(0,i.j4)(M,{key:t.id,notification:t,onMark_read:function(){return g(t)},onPostpone:function(){return w(t)}},null,8,["notification","onMark_read","onPostpone"])})),128))])]})),footer:(0,i.w5)((function(){return[(0,i._)("button",{type:"button",onClick:n[0]||(n[0]=function(n){return t.$emit("close")}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer ")]})),_:1},512)}));case 13:case"end":return t.stop()}}),t)})))()}};var F={class:"notification_counter"},$=["title","aria-label","disabled"],q={key:0,class:"bubble"};const A={__name:"NotificationListComponent",setup:function(t){var n=v(),e=(0,l.Jk)(n),o=(e.collectionMetaData,e.collection),u=n.loadChannel,s=n.markRead,f=n.postPone,d=(0,i.Fl)((function(){return o.value?"Afficher ".concat(o.value.length," notifications"):"Aucune notification"})),p=(0,a.iH)(!1),m=(0,a.iH)(!1);function _(){p.value=!p.value}function h(){console.log("Showing the popup with all notifications"),m.value=!0,p.value=!1}function b(){m.value=!1,p.value=!1}var g=(0,a.iH)(null);(0,c.i9H)(g,(function(t){p&&(m.value||(p.value=!1))}));var w=function(t){s(t)},y=function(t){f(t)};return u(5),function(t,e){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",F,[((0,i.wg)(),(0,i.iD)("button",{class:"icon unstyled",title:(0,a.SU)(d),"aria-label":(0,a.SU)(d),onClick:_,disabled:!(0,a.SU)(n).notificationCount,key:(0,a.SU)(n).notificationCount},[(0,i.Wm)(k.Z,{name:"bell"}),(0,a.SU)(n).notificationCount>0?((0,i.wg)(),(0,i.iD)("span",q,(0,r.zw)((0,a.SU)(n).notificationCount),1)):(0,i.kq)("v-if",!0)],8,$))]),p.value?((0,i.wg)(),(0,i.j4)(x,{key:0,notifications:(0,a.SU)(o),notificationCount:(0,a.SU)(n).notificationCount,onShowAll:h,onMark_read:w,onPostpone:y,ref_key:"dropDownTarget",ref:g},null,8,["notifications","notificationCount"])):(0,i.kq)("v-if",!0),m.value?((0,i.wg)(),(0,i.j4)(L,{key:1,ref:"alertTarget",onClose:b,onMark_read:w,onPostpone:y},null,512)):(0,i.kq)("v-if",!0)],64)}}},W={__name:"MessageApp",setup:function(t){return function(t,n){return(0,i.wg)(),(0,i.j4)(i.n4,null,{fallback:(0,i.w5)((function(){return[(0,i.Uk)(" Chargement... ")]})),default:(0,i.w5)((function(){return[(0,i.Wm)(A)]})),_:1})}}};var N=["innerHTML"],R=["innerHTML"];const z={__name:"NotificationModal",props:{notification:Object},emits:["postpone","mark_read"],setup:function(t,n){return n.emit,function(n,e){return(0,i.wg)(),(0,i.j4)(T,{onClose:e[2]||(e[2]=function(e){return n.$emit("mark_read",t.notification)})},{header:(0,i.w5)((function(){return[(0,i._)("span",{innerHTML:t.notification.title},null,8,N)]})),body:(0,i.w5)((function(){return[(0,i._)("span",{innerHTML:t.notification.body},null,8,R)]})),footer:(0,i.w5)((function(){return[(0,i._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer "),(0,i._)("button",{type:"button",class:"btn btn-secondary",onClick:e[1]||(e[1]=function(e){return n.$emit("postpone",t.notification)}),title:"Me le rappeler plus tard","aria-label":"Me le rappeler plus tard"}," Plus tard ")]})),_:1})}}},E={__name:"AlertApp",setup:function(t){var n=b(),e=(0,l.Jk)(n),o=e.collectionMetaData,r=e.collection,c=function(t){n.markRead(t).then((function(){return n.loadChannel(1)}))},u=function(t){n.postPone(t).then((function(){return n.loadChannel(1)}))};return n.loadChannel(1),function(t,n){return(0,a.SU)(o).total_entries?((0,i.wg)(),(0,i.j4)(z,{key:0,notification:(0,a.SU)(r)[0],onMark_read:c,onPostpone:u},null,8,["notification"])):(0,i.kq)("v-if",!0)}}};var I={class:"notification"},J={class:"alert alert-warning align_center"},G={class:"icon"},Y=[(0,i._)("svg",{class:""},[(0,i._)("use",{href:"/static/icons/endi.svg#times"})],-1)];const K={__name:"Notification",props:{notification:Object},emits:["mark_read"],setup:function(t,n){n.emit;var e=t,o=e.notification.title+"<br />"+e.notification.body;return function(n,e){return(0,i.wg)(),(0,i.iD)("div",I,[(0,i._)("div",J,[(0,i._)("span",G,[(0,i.Wm)(k.Z,{name:"exclamation-triangle"})]),(0,i._)("div",null,[(0,i._)("strong",{innerHTML:o})]),(0,i._)("button",{type:"button",class:"icon only unstyled close",title:"Masquer ce message","aria-label":"Masquer ce message",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)})},Y)])])}}},Q={__name:"HeaderMessageApp",setup:function(t){var n=h(),e=(0,l.Jk)(n),o=e.collectionMetaData,r=e.collection,c=function(t){n.markRead(t).then((function(){return n.loadChannel(1)}))};n.loadChannel(1);var u=(0,i.Fl)((function(){return r.value[0]}));return function(t,n){return(0,a.SU)(o).total_entries&&!t.loading?((0,i.wg)(),(0,i.j4)(K,{key:0,notification:u.value,onMark_read:c},null,8,["notification"])):(0,i.kq)("v-if",!0)}}};(0,o.GP)(W,"vue-notification-message-app"),(0,o.GP)(E,"vue-notification-alert-app"),(0,o.GP)(Q,"vue-notification-header_message-app")}},e={};function o(t){var i=e[t];if(void 0!==i)return i.exports;var a=e[t]={exports:{}};return n[t].call(a.exports,a,a.exports,o),a.exports}o.m=n,t=[],o.O=(n,e,i,a)=>{if(!e){var r=1/0;for(s=0;s<t.length;s++){for(var[e,i,a]=t[s],c=!0,l=0;l<e.length;l++)(!1&a||r>=a)&&Object.keys(o.O).every((t=>o.O[t](e[l])))?e.splice(l--,1):(c=!1,a<r&&(r=a));if(c){t.splice(s--,1);var u=i();void 0!==u&&(n=u)}}return n}a=a||0;for(var s=t.length;s>0&&t[s-1][2]>a;s--)t[s]=t[s-1];t[s]=[e,i,a]},o.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return o.d(n,{a:n}),n},o.d=(t,n)=>{for(var e in n)o.o(n,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.j=599,(()=>{var t={599:0};o.O.j=n=>0===t[n];var n=(n,e)=>{var i,a,[r,c,l]=e,u=0;if(r.some((n=>0!==t[n]))){for(i in c)o.o(c,i)&&(o.m[i]=c[i]);if(l)var s=l(o)}for(n&&n(e);u<r.length;u++)a=r[u],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(s)},e=self.webpackChunkenDI=self.webpackChunkenDI||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))})();var i=o.O(void 0,[382],(()=>o(4215)));i=o.O(i)})();